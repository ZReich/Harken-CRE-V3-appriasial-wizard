<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comps - Harken CRE</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Montserrat', sans-serif;
        }

        .material-icons {
            font-family: 'Material Icons' !important;
        }

        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Premium Navbar */
        .navbar {
            background: url(https://app.harkenbov.com/assets/img/accent-white-bright.png) top left/contain #1c3643;
            background-color: #1c3643 !important;
            height: 70px;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 20px;
            border-radius: 25px;
            transition: all 0.2s;
            border: 1px solid transparent;
            font-weight: 500;
            font-size: 14px;
        }

        .nav-link:hover {
            background-color: rgba(255,255,255,0.05);
        }

        .nav-link.active {
            background-color: transparent;
            border: 1px solid #0da1c7;
            color: #0da1c7;
        }

        /* Control Bar */
        .control-bar {
            background-color: white;
            padding: 16px 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .search-input, .filter-select {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            color: #687F8B;
            transition: all 0.2s;
        }

        .search-input:focus, .filter-select:focus {
            outline: none;
            border-color: #0da1c7;
        }

        /* Premium Multi-select dropdown */
        .multi-select {
            position: relative;
            display: inline-block;
        }

        .multi-select-button {
            padding: 10px 14px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13px;
            background-color: white;
            color: #687F8B;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            width: 180px;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
            white-space: nowrap;
        }

        .multi-select-button:hover {
            border-color: #0da1c7;
        }

        .multi-select-button::after {
            content: '';
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid #687F8B;
            transition: transform 0.2s;
            margin-left: 8px;
            flex-shrink: 0;
        }

        .multi-select.open .multi-select-button::after {
            transform: rotate(180deg);
        }

        .multi-select-label {
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .filter-tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
            min-height: 32px;
            align-items: center;
        }

        .filter-tags-label {
            font-size: 12px;
            color: #687F8B;
            font-weight: 600;
            margin-right: 4px;
        }

        .selection-tag {
            background: linear-gradient(135deg, #0da1c7 0%, #38bfd9 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            animation: tagSlideIn 0.2s ease-out;
        }

        .selection-tag-type {
            background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            animation: tagSlideIn 0.2s ease-out;
        }

        @keyframes tagSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .tag-remove {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
            line-height: 1;
            opacity: 0.9;
            transition: all 0.2s;
            width: 14px;
            height: 14px;
        }

        .tag-remove:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .multi-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #0da1c7;
            border-radius: 8px;
            margin-top: 4px;
            box-shadow: 0 8px 24px rgba(13, 161, 199, 0.15);
            z-index: 1000;
            display: none;
            max-height: 300px;
            overflow-y: auto;
            animation: dropdownSlideDown 0.2s ease-out;
        }

        @keyframes dropdownSlideDown {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .multi-select-dropdown.show {
            display: block;
        }

        .multi-select-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 13px;
            color: #1c3643;
            font-weight: 500;
            border-left: 3px solid transparent;
        }

        .multi-select-option:hover {
            background: linear-gradient(90deg, #f0fbfd 0%, #ffffff 100%);
            border-left-color: #0da1c7;
        }

        .multi-select-option.selected {
            background: linear-gradient(90deg, #e8f9fc 0%, #f0fbfd 100%);
            border-left-color: #0da1c7;
            color: #0da1c7;
            font-weight: 600;
        }

        .multi-select-option.selected::after {
            content: 'check';
            font-family: 'Material Icons';
            font-size: 18px;
            color: #0da1c7;
        }

        .multi-select-placeholder {
            color: #687F8B;
            font-size: 13px;
        }

        .btn-primary {
            background-color: #0da1c7;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            border: none;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary:hover {
            background-color: #0b8aad;
            box-shadow: 0 2px 8px rgba(13, 161, 199, 0.3);
        }

        .btn-filters {
            background: white;
            color: #0da1c7;
            border: 1px solid #0da1c7;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-filters:hover {
            background: #0da1c7;
            color: white;
        }

        /* Split View */
        .split-container {
            display: flex;
            height: calc(100vh - 140px);
            background: #f5f5f5;
            position: relative;
        }

        .map-section {
            flex: 1;
            position: relative;
            background: white;
            min-width: 0;
        }

        #map {
            width: 100%;
            height: 100%;
            background-image: url('https://api.mapbox.com/styles/v1/mapbox/light-v10/static/-98.5795,39.8283,4/1200x800@2x?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw');
            background-size: cover;
            background-position: center;
            position: relative;
        }

        /* Map Pin Styles */
        .map-pin {
            position: absolute;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 10;
        }

        .map-pin:hover {
            transform: scale(1.15);
            z-index: 100;
        }

        .pin-marker {
            position: relative;
            width: 40px;
            height: 40px;
            background: #0da1c7;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 11px;
            color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .pin-cluster {
            width: 50px;
            height: 50px;
            background: #0da1c7;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }

        .price-label {
            background: #0da1c7;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 13px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            white-space: nowrap;
        }

        /* Popup */
        .map-popup {
            position: absolute;
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 220px;
            z-index: 1000;
            display: none;
            pointer-events: none;
        }

        .map-pin:hover .map-popup {
            display: block;
        }

        .popup-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .popup-title {
            font-size: 14px;
            font-weight: 700;
            color: #0da1c7;
            margin-bottom: 4px;
        }

        /* Status in map popups - matching card styles */
        .popup-status {
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
            display: inline-block;
            margin-left: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .popup-status.status-active {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }

        .popup-status.status-pending {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ff9800;
        }

        .popup-status.status-sold {
            background: #f3e5f5;
            color: #6a1b9a;
            border: 1px solid #9c27b0;
        }

        .popup-address {
            font-size: 11px;
            color: #687F8B;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .popup-content {
            display: flex;
            gap: 12px;
            margin-bottom: 8px;
        }

        .popup-left {
            flex: 1;
        }

        .popup-right {
            flex: 1;
        }

        .popup-info {
            font-size: 11px;
            color: #1c3643;
            margin-bottom: 4px;
            line-height: 1.5;
        }

        .popup-label {
            color: #687F8B;
            font-weight: 600;
        }

        .popup-actions {
            display: flex;
            gap: 6px;
            margin-top: 8px;
        }

        .popup-btn {
            flex: 1;
            padding: 6px 8px;
            border-radius: 4px;
            border: none;
            font-weight: 600;
            font-size: 11px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .popup-btn-view {
            background: #0da1c7;
            color: white;
        }

        .popup-btn-view:hover {
            background: #0b8aad;
        }

        .popup-btn-edit {
            background: white;
            color: #687F8B;
            border: 1px solid #e0e0e0;
        }

        .popup-btn-edit:hover {
            border-color: #0da1c7;
            color: #0da1c7;
        }

        .list-section {
            width: 420px;
            flex-shrink: 0;
            background: #f5f5f5;
            overflow-y: auto;
            padding: 0 16px 16px 16px;
            border-left: 1px solid #e0e0e0;
        }

        /* Property Card matching current design */
        .property-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .property-card:hover {
            border-color: #0da1c7;
            box-shadow: 0 2px 8px rgba(13, 161, 199, 0.2);
        }

        .property-card.active {
            border-color: #0da1c7;
            background: #f0fbfd;
        }

        /* New Icon-Only Hover Actions */
        .card-actions-overlay {
            position: absolute;
            top: 12px;
            right: 12px;
            display: flex;
            gap: 6px;
            opacity: 0;
            transform: translateY(-8px);
            transition: all 0.2s ease;
            pointer-events: none;
            z-index: 10;
        }

        .property-card:hover .card-actions-overlay {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .action-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            transition: all 0.2s;
        }

        .action-icon:hover {
            background: #0da1c7;
            color: white;
            transform: scale(1.1);
        }

        .action-icon.action-delete:hover {
            background: #ef4444;
        }

        .action-icon .material-icons {
            font-size: 18px;
            color: #687F8B;
        }

        .action-icon:hover .material-icons {
            color: white;
        }

        /* Tooltip */
        .action-icon[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 4px;
            padding: 4px 8px;
            background: rgba(28, 54, 67, 0.95);
            color: white;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
            border-radius: 4px;
            pointer-events: none;
            z-index: 1000;
        }

        .property-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 12px;
        }

        .property-content {
            display: flex;
            gap: 12px;
        }

        .property-left {
            flex: 1;
            min-width: 0;
        }

        .property-right {
            flex: 1;
            min-width: 0;
        }

        .property-title {
            font-size: 14px;
            font-weight: 700;
            color: #0da1c7;
            margin-bottom: 4px;
        }

        /* Status badges with different colors */
        .property-status {
            font-size: 11px;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-left: 6px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .status-active {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }

        .status-pending {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ff9800;
        }

        .status-sold {
            background: #f3e5f5;
            color: #6a1b9a;
            border: 1px solid #9c27b0;
        }

        .status-closed {
            background: #fafafa;
            color: #616161;
            border: 1px solid #9e9e9e;
        }

        /* Selection Checkbox Styles */
        .selection-checkbox-container {
            position: absolute;
            top: 8px;
            left: 8px;
            z-index: 10;
            cursor: pointer;
        }

        .selection-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            appearance: none;
            background: white;
            border: 2px solid #0da1c7;
            border-radius: 4px;
            position: relative;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .selection-checkbox:hover {
            background: #f0f9fb;
            box-shadow: 0 2px 6px rgba(13,161,199,0.3);
        }

        .selection-checkbox:checked {
            background: #0da1c7;
            border-color: #0da1c7;
        }

        .selection-checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        /* Selection counter badge */
        .selection-count-badge {
            background: #0da1c7;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 6px;
            white-space: nowrap;
        }

        .print-with-count {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* List Header Section - Static */
        .list-header-section {
            background: #f5f5f5;
            border-bottom: 1px solid #e0e0e0;
            padding: 0 24px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        /* Property type badge - keep your brand blue */
        .property-type-badge {
            background: #e0f7fc;
            color: #0da1c7;
            border: 1px solid #0da1c7;
            font-size: 11px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-block;
            text-transform: capitalize;
        }

        .property-address {
            font-size: 11px;
            color: #687F8B;
            font-weight: 500;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .property-info {
            font-size: 11px;
            color: #1c3643;
            font-weight: 500;
            margin-bottom: 4px;
            line-height: 1.5;
        }

        .property-label {
            color: #687F8B;
            font-weight: 600;
        }

        .property-price {
            font-size: 14px;
            font-weight: 700;
            color: #0da1c7;
            margin-bottom: 4px;
        }

        /* Old action buttons styles removed - now using icon overlay */

        /* Custom Cluster Marker Styles */
        .cluster-marker {
            background: #0da1c7;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            border: 3px solid white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .cluster-marker:hover {
            transform: scale(1.1);
        }

        /* Price Label on Map */
        .price-label {
            background: #0da1c7;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            white-space: nowrap;
            cursor: pointer;
        }

        .price-label:hover {
            background: #0b8aad;
        }

        /* Info Window */
        .custom-info-window {
            padding: 12px;
            min-width: 280px;
        }

        .info-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .info-title {
            font-size: 14px;
            font-weight: 700;
            color: #0da1c7;
            margin-bottom: 4px;
        }

        .info-address {
            font-size: 12px;
            color: #687F8B;
            margin-bottom: 8px;
        }

        .info-price {
            font-size: 16px;
            font-weight: 700;
            color: #0da1c7;
            margin-bottom: 8px;
        }

        .info-details {
            font-size: 11px;
            color: #1c3643;
            line-height: 1.6;
        }

        .info-btn {
            width: 100%;
            margin-top: 8px;
            padding: 6px;
            background: #0da1c7;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            font-size: 12px;
            cursor: pointer;
        }

        /* Scrollbar */
        .list-section::-webkit-scrollbar {
            width: 6px;
        }

        .list-section::-webkit-scrollbar-track {
            background: #f9f9f9;
        }

        .list-section::-webkit-scrollbar-thumb {
            background: #d0d0d0;
            border-radius: 3px;
        }

        .list-section::-webkit-scrollbar-thumb:hover {
            background: #0da1c7;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 16px;
            padding-bottom: 16px;
        }

        .page-btn {
            padding: 6px 12px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            color: #687F8B;
        }

        .page-btn:hover {
            border-color: #0da1c7;
            color: #0da1c7;
        }

        .page-btn.active {
            background: #0da1c7;
            color: white;
            border-color: #0da1c7;
        }

        /* Toggle Radio Buttons */
        .toggle-group {
            display: inline-flex;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .toggle-radio {
            padding: 6px 16px;
            border: none;
            background: white;
            color: #687F8B;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border-right: 1px solid #e0e0e0;
        }

        .toggle-radio:last-child {
            border-right: none;
        }

        .toggle-radio.active {
            background: #0da1c7;
            color: white;
        }

        .toggle-radio:hover:not(.active) {
            background: #f9f9f9;
        }

        /* Comp Type Tabs */
        .comp-tabs {
            background: white;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            padding: 0 24px;
            gap: 4px;
        }

        .comp-tab {
            padding: 16px 24px;
            border: none;
            background: transparent;
            color: #687F8B;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .comp-tab:hover {
            color: #0da1c7;
            background: #f0fbfd;
        }

        .comp-tab.active {
            color: #0da1c7;
            border-bottom-color: #0da1c7;
            background: #f0fbfd;
        }

        /* Search Input with Icon */
        .search-container {
            position: relative;
            display: inline-block;
        }

        .search-container .material-icons {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #687F8B;
            font-size: 20px;
            pointer-events: none;
        }

        .search-container .search-input {
            padding-left: 40px;
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }

        .modal-overlay.show {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-panel {
            background: white;
            border-radius: 8px;
            max-width: 90%;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: #1c3643;
        }

        .modal-close {
            background: none;
            border: none;
            color: #687F8B;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            transition: all 0.2s;
        }

        .modal-close:hover {
            color: #0da1c7;
            transform: scale(1.1);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Filter Modal Specific */
        .filter-section {
            margin-bottom: 24px;
        }

        .filter-section-title {
            font-size: 14px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 12px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .filter-field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: #687F8B;
        }

        .filter-input {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13px;
            color: #1c3643;
            transition: all 0.2s;
        }

        .filter-input:focus {
            outline: none;
            border-color: #0da1c7;
            box-shadow: 0 0 0 3px rgba(13, 161, 199, 0.1);
        }

        /* Upload Modal Specific */
        .upload-zone {
            border: 2px dashed #0da1c7;
            border-radius: 8px;
            padding: 48px 24px;
            text-align: center;
            background: #f0fbfd;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            z-index: 1;
        }
        .upload-zone * {
            pointer-events: none;
        }

        .upload-zone:hover {
            background: #e8f9fc;
            border-color: #0b8aad;
        }

        .upload-zone.drag-over {
            background: #d0f4fa;
            border-color: #0b8aad;
        }

        .upload-icon {
            font-size: 64px;
            color: #0da1c7;
            margin-bottom: 16px;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 600;
            color: #1c3643;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 13px;
            color: #687F8B;
        }

        .file-list {
            margin-top: 24px;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f9f9f9;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .file-icon {
            color: #0da1c7;
            margin-right: 12px;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-size: 13px;
            font-weight: 600;
            color: #1c3643;
        }

        .file-size {
            font-size: 11px;
            color: #687F8B;
        }

        .file-remove {
            background: none;
        }

        /* Bulk Upload Multi-Step Styles */
        .upload-step {
            display: none;
        }
        .upload-step.active {
            display: block;
        }
        .upload-modal-expanded {
            width: 95% !important;
            max-width: 1200px !important;
        }
        .upload-progress {
            text-align: center;
            padding: 60px 24px;
        }
        .upload-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e0e0e0;
            border-top-color: #0da1c7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .upload-progress-text {
            font-size: 16px;
            font-weight: 600;
            color: #1c3643;
            margin-bottom: 8px;
        }
        .upload-progress-subtext {
            font-size: 13px;
            color: #687F8B;
        }
        .duplicate-summary {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }
        .summary-stat {
            flex: 1;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }
        .summary-stat.total {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
        }
        .summary-stat.new {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
        }
        .summary-stat.duplicate {
            background: #fef3c7;
            border: 1px solid #fde68a;
        }
        .summary-stat.skip {
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
        }
        .summary-stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #1c3643;
        }
        .summary-stat-label {
            font-size: 12px;
            font-weight: 600;
            color: #687F8B;
            text-transform: uppercase;
            margin-top: 4px;
        }
        .duplicate-table-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .duplicate-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .duplicate-table th {
            background: #f8fafc;
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: #1c3643;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        .duplicate-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }
        .duplicate-table tr:hover {
            background: #f9f9f9;
        }
        .match-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        .match-badge.high {
            background: #fef2f2;
            color: #dc2626;
        }
        .match-badge.medium {
            background: #fef3c7;
            color: #b45309;
        }
        .match-badge.low {
            background: #f0f9ff;
            color: #0369a1;
        }
        .match-badge.new {
            background: #f0fdf4;
            color: #059669;
        }
        .action-select {
            padding: 6px 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 12px;
            background: white;
            cursor: pointer;
            min-width: 140px;
        }
        .action-select:focus {
            outline: none;
            border-color: #0da1c7;
        }
        .compare-btn {
            padding: 6px 12px;
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 4px;
            color: #0369a1;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .compare-btn:hover {
            background: #e0f2fe;
        }
        .note-input-small {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 11px;
            font-family: inherit;
            color: #1c3643;
            background: white;
            transition: border-color 0.2s;
        }
        .note-input-small:focus {
            outline: none;
            border-color: #0da1c7;
        }
        .note-input-small::placeholder {
            color: #a0a0a0;
        }
        .bulk-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        .bulk-actions-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .bulk-action-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .bulk-action-btn.create-all {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #059669;
        }
        .bulk-action-btn.update-all {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            color: #0369a1;
        }
        .bulk-action-btn.skip-all {
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            color: #687F8B;
        }
        .bulk-action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* Compare Modal */
        .compare-modal-overlay {
            display: none !important;
            position: fixed !important;
            inset: 0 !important;
            background: rgba(0,0,0,0.7) !important;
            z-index: 9999 !important;
            align-items: center;
            justify-content: center;
        }
        .compare-modal-overlay.active {
            display: flex !important;
        }
        .compare-modal {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            z-index: 10000 !important;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .compare-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e0e0e0;
        }
        .compare-modal-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: #1c3643;
            margin: 0;
        }
        .compare-modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: #687F8B;
            padding: 4px;
        }
        .compare-modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }
        .compare-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        .compare-column {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        .compare-column-header {
            padding: 16px;
            font-weight: 600;
            font-size: 14px;
        }
        .compare-column.uploaded .compare-column-header {
            background: #f0f9ff;
            color: #0369a1;
            border-bottom: 2px solid #0da1c7;
        }
        .compare-column.existing .compare-column-header {
            background: #f5f5f5;
            color: #687F8B;
            border-bottom: 2px solid #e0e0e0;
        }
        .compare-field {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        .compare-field:last-child {
            border-bottom: none;
        }
        .compare-field-label {
            font-size: 12px;
            font-weight: 600;
            color: #687F8B;
            text-transform: uppercase;
        }
        .compare-field-value {
            font-size: 14px;
            font-weight: 500;
            color: #1c3643;
        }
        .compare-field.different {
            background: #fef3c7;
        }
        .compare-field.different .compare-field-value {
            font-weight: 700;
        }
        .compare-modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        .upload-step-header {
            margin-bottom: 20px;
        }
        .upload-step-title {
            font-size: 18px;
            font-weight: 600;
            color: #1c3643;
            margin-bottom: 8px;
        }
        .upload-step-desc {
            font-size: 14px;
            color: #687F8B;
        }
        .upload-success {
            text-align: center;
            padding: 60px 24px;
        }
        .success-icon {
            width: 80px;
            height: 80px;
            background: #d1fae5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
        }
        .success-icon i {
            font-size: 40px;
            color: #059669;
        }
        .success-title {
            font-size: 20px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 8px;
        }
        .success-desc {
            font-size: 14px;
            color: #687F8B;
            margin-bottom: 24px;
        }
        .success-stats {
            display: flex;
            justify-content: center;
            gap: 32px;
        }
        .success-stat {
            text-align: center;
        }
        .success-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #0da1c7;
        }
        .success-stat-label {
            font-size: 12px;
            color: #687F8B;
        }

        /* Help & Walkthrough Styles */
        .help-banner {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .help-banner-icon {
            width: 40px;
            height: 40px;
            background: #0da1c7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .help-banner-icon i {
            color: white;
            font-size: 20px;
        }
        .help-banner-content {
            flex: 1;
        }
        .help-banner-title {
            font-size: 14px;
            font-weight: 600;
            color: #0369a1;
            margin-bottom: 4px;
        }
        .help-banner-text {
            font-size: 13px;
            color: #0c4a6e;
            line-height: 1.5;
        }
        .help-banner-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        .help-banner-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .help-banner-btn.primary {
            background: #0da1c7;
            color: white;
            border: none;
        }
        .help-banner-btn.primary:hover {
            background: #0b8aad;
        }
        .help-banner-btn.secondary {
            background: white;
            color: #0369a1;
            border: 1px solid #bae6fd;
        }
        .help-banner-btn.secondary:hover {
            background: #f0f9ff;
        }
        .help-banner-dismiss {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 4px;
            font-size: 18px;
            line-height: 1;
        }
        .help-banner-dismiss:hover {
            color: #1e293b;
        }
        .help-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: #e0e0e0;
            border-radius: 50%;
            font-size: 10px;
            font-weight: 700;
            color: #687F8B;
            cursor: help;
            margin-left: 6px;
            position: relative;
        }
        .help-icon:hover {
            background: #0da1c7;
            color: white;
        }
        .help-tooltip {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: #1c3643;
            color: white;
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 400;
            white-space: nowrap;
            max-width: 280px;
            white-space: normal;
            text-align: left;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            line-height: 1.4;
        }
        .help-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1c3643;
        }
        .help-icon:hover .help-tooltip {
            opacity: 1;
            visibility: visible;
        }
        /* Walkthrough Overlay */
        .walkthrough-overlay {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 3000;
        }
        .walkthrough-overlay.active {
            display: block;
        }
        .walkthrough-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 3000;
        }
        .walkthrough-highlight {
            position: fixed;
            background: transparent;
            border-radius: 8px;
            box-shadow: 0 0 0 4px #0da1c7, 0 0 0 9999px rgba(0,0,0,0.7);
            z-index: 3001;
            transition: all 0.3s ease;
            pointer-events: none;
        }
        .walkthrough-tooltip {
            position: fixed;
            background: white;
            border-radius: 12px;
            padding: 20px 24px;
            width: 320px;
            max-width: calc(100vw - 40px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 3002;
        }
        .walkthrough-step-indicator {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
        }
        .walkthrough-step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e0e0e0;
        }
        .walkthrough-step-dot.active {
            background: #0da1c7;
        }
        .walkthrough-step-dot.completed {
            background: #10b981;
        }
        .walkthrough-title {
            font-size: 16px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 8px;
        }
        .walkthrough-text {
            font-size: 14px;
            color: #687F8B;
            line-height: 1.5;
            margin-bottom: 16px;
        }
        .walkthrough-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .walkthrough-skip {
            background: none;
            border: none;
            color: #687F8B;
            font-size: 13px;
            cursor: pointer;
        }
        .walkthrough-skip:hover {
            color: #1c3643;
            text-decoration: underline;
        }
        .walkthrough-nav {
            display: flex;
            gap: 8px;
        }
        .walkthrough-btn {
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .walkthrough-btn.back {
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            color: #687F8B;
        }
        .walkthrough-btn.next {
            background: #0da1c7;
            border: none;
            color: white;
        }
        .walkthrough-btn.next:hover {
            background: #0b8aad;
        }
        .help-header-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 6px;
            color: #0369a1;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .help-header-btn:hover {
            background: #e0f2fe;
        }
        .help-header-btn i {
            font-size: 18px;
        }
            border: none;
            color: #ef4444;
            cursor: pointer;
            padding: 4px;
        }

        /* Add New Comp Wizard */
        .wizard-container {
            display: flex;
            width: 1000px;
            height: 600px;
        }

        .wizard-sidebar {
            width: 240px;
            background: #f5f5f5;
            border-right: 1px solid #e0e0e0;
            padding: 24px 16px;
        }

        .wizard-step {
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }

        .wizard-step:hover {
            background: #e8f9fc;
        }

        .wizard-step.active {
            background: #0da1c7;
            color: white;
        }

        .wizard-step.completed {
            background: #e8f9fc;
            color: #0da1c7;
        }

        .wizard-step-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: white;
            color: #687F8B;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
        }

        .wizard-step.active .wizard-step-number {
            background: white;
            color: #0da1c7;
        }

        .wizard-step.completed .wizard-step-number {
            background: #0da1c7;
            color: white;
        }

        .wizard-step-title {
            font-size: 13px;
            font-weight: 600;
        }

        .wizard-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .wizard-header {
            padding: 24px;
            border-bottom: 1px solid #e0e0e0;
        }

        .wizard-progress {
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .wizard-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #0da1c7 0%, #38bfd9 100%);
            transition: width 0.3s ease-out;
        }

        .wizard-step-info {
            font-size: 12px;
            color: #687F8B;
            margin-bottom: 4px;
        }

        .wizard-step-heading {
            font-size: 18px;
            font-weight: 700;
            color: #1c3643;
        }

        .wizard-body {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-field.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: 13px;
            font-weight: 600;
            color: #1c3643;
        }

        .form-label .required {
            color: #ef4444;
        }

        .form-input {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13px;
            color: #1c3643;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #0da1c7;
            box-shadow: 0 0 0 3px rgba(13, 161, 199, 0.1);
        }

        .form-input.error {
            border-color: #ef4444;
        }

        .form-error {
            font-size: 11px;
            color: #ef4444;
            margin-top: 4px;
        }

        .form-hint {
            font-size: 11px;
            color: #687F8B;
            margin-top: 4px;
        }

        .wizard-footer {
            padding: 16px 24px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
        }

        .btn-secondary {
            background: white;
            color: #687F8B;
            border: 1px solid #e0e0e0;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            border-color: #0da1c7;
            color: #0da1c7;
        }

        .btn-draft {
            background: #f0fbfd;
            color: #0da1c7;
            border: 1px solid #0da1c7;
        }

        .btn-draft:hover {
            background: #e8f9fc;
        }

        textarea.form-input {
            resize: vertical;
            min-height: 80px;
        }

        .image-upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 4px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .image-upload-area:hover {
            border-color: #0da1c7;
            background: #f0fbfd;
        }

        .image-preview {
            max-width: 200px;
            max-height: 150px;
            margin: 12px auto;
            border-radius: 4px;
        }

        /* Evaluation List Styles */
        #evaluationContainer {
            display: none;
            background-color: #f5f5f5;
            padding: 24px;
            min-height: calc(100vh - 150px);
        }

        .evaluation-header {
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .evaluation-title {
            font-size: 23px;
            font-weight: 600;
            color: #1c3643;
        }

        .evaluation-search-bar {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .evaluation-search-container {
            position: relative;
            display: inline-block;
        }

        .evaluation-search-container .material-icons {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #687F8B;
            font-size: 20px;
            pointer-events: none;
        }

        .evaluation-search-input {
            width: 390px;
            padding: 10px 16px 10px 40px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
        }

        .evaluation-search-input:focus {
            outline: none;
            border-color: #0da1c7;
        }


        .evaluation-table-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            overflow: hidden;
        }

        .evaluation-table {
            width: 100%;
            background-color: white;
            border-collapse: separate;
            border-spacing: 0;
        }

        .evaluation-table thead {
            background-color: #f9f9f9;
        }

        .evaluation-table th {
            padding: 16px 35px;
            text-align: left;
            color: #687F8B;
            font-size: 13px;
            font-weight: 600;
            border-bottom: 2px solid #e0e0e0;
        }

        .evaluation-table th.sortable {
            cursor: pointer;
            user-select: none;
        }

        .evaluation-table th.sortable:hover {
            color: #0da1c7;
        }

        .evaluation-table td {
            padding: 20px 35px;
            color: #687F8B;
            font-size: 13px;
            font-weight: 500;
            border-bottom: 1px solid #f0f0f0;
        }

        .evaluation-table tbody tr:hover {
            background-color: #f9f9f9;
        }

        .evaluation-link {
            color: #0da1c7;
            text-decoration: none;
            font-weight: 600;
        }

        .evaluation-link:hover {
            text-decoration: underline;
        }

        .evaluation-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .evaluation-action-btn {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            border: 1px solid transparent;
            background-color: transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .evaluation-action-btn .material-icons {
            font-size: 18px;
        }

        .evaluation-action-btn.edit .material-icons {
            color: #0da1c7;
        }

        .evaluation-action-btn.delete .material-icons {
            color: #dc3545;
        }

        .evaluation-action-btn.pdf .material-icons {
            color: #dc3545;
        }

        .evaluation-action-btn:hover {
            background-color: rgba(13, 161, 199, 0.08);
            border-color: rgba(13, 161, 199, 0.2);
        }

        .evaluation-action-btn.delete:hover,
        .evaluation-action-btn.pdf:hover {
            background-color: rgba(220, 53, 69, 0.08);
            border-color: rgba(220, 53, 69, 0.2);
        }

        /* Tooltip styles */
        .evaluation-action-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background-color: #1c3643;
            color: white;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }

        .evaluation-action-btn::before {
            content: '';
            position: absolute;
            bottom: calc(100% + 2px);
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1c3643;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }

        .evaluation-action-btn:hover::after,
        .evaluation-action-btn:hover::before {
            opacity: 1;
        }

        .approaches-container {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .approach-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }

        /* Sales Approach - Blue (Primary/Most Common) */
        .approach-sales {
            background-color: #e3f2fd;
            color: #1565c0;
        }

        /* Income Approach - Green (Revenue/Money) */
        .approach-income {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        /* Cost Approach - Orange (Construction/Building) */
        .approach-cost {
            background-color: #fff3e0;
            color: #e65100;
        }

        /* Lease Approach - Purple (Rental/Contracts) */
        .approach-lease {
            background-color: #f3e5f5;
            color: #6a1b9a;
        }

        /* Cap Approach - Teal (Financial Analysis) */
        .approach-cap {
            background-color: #e0f2f1;
            color: #00695c;
        }

        /* Multi-Family Approach - Indigo (Residential) */
        .approach-multifamily {
            background-color: #e8eaf6;
            color: #3949ab;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 20px;
            background-color: white;
        }

        .pagination-btn {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            background-color: white;
            color: #687F8B;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .pagination-btn:hover {
            border-color: #0da1c7;
            color: #0da1c7;
        }

        .pagination-btn.active {
            background-color: #0da1c7;
            color: white;
            border-color: #0da1c7;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Evaluation Wizard Modal Styles */
        .wizard-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            overflow-y: auto;
            padding: 40px 20px;
        }

        .wizard-modal-overlay.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .wizard-modal {
            background: white;
            border-radius: 8px;
            max-width: 1200px;
            width: 100%;
            margin: auto;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .wizard-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #e0e0e0;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #687F8B;
            font-size: 24px;
            transition: all 0.2s;
            z-index: 10;
        }

        .wizard-close:hover {
            border-color: #dc3545;
            color: #dc3545;
            transform: rotate(90deg);
        }

        .wizard-container {
            padding: 50px;
        }

        .wizard-title {
            text-align: center;
            font-size: 28px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 12px;
        }

        .wizard-subtitle {
            text-align: center;
            color: #687F8B;
            font-size: 14px;
            margin-bottom: 40px;
        }

        .wizard-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            gap: 20px;
            flex-wrap: wrap;
        }

        .wizard-step {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            color: #687F8B;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            flex-shrink: 0;
        }

        .step-circle.active {
            background: #0da1c7;
            color: white;
        }

        .step-circle.completed {
            background: #2e7d32;
            color: white;
        }

        .step-label {
            font-size: 14px;
            font-weight: 600;
            color: #687F8B;
            white-space: nowrap;
        }

        .step-label.active {
            color: #1c3643;
        }

        .step-arrow {
            color: #e0e0e0;
            font-size: 20px;
        }

        .wizard-card {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 40px;
            margin-bottom: 24px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 12px;
        }

        .card-subtitle {
            font-size: 14px;
            color: #687F8B;
            margin-bottom: 32px;
            line-height: 1.6;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 16px;
            border-radius: 4px;
            margin-bottom: 24px;
        }

        .info-box-title {
            font-size: 14px;
            font-weight: 700;
            color: #1565c0;
            margin-bottom: 8px;
        }

        .info-box-text {
            font-size: 13px;
            color: #1976d2;
            line-height: 1.6;
        }

        .template-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .template-option {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .template-option:hover {
            border-color: #0da1c7;
            box-shadow: 0 4px 12px rgba(13, 161, 199, 0.15);
        }

        .template-option.selected {
            border-color: #0da1c7;
            background: linear-gradient(to bottom, #e8f5f7 0%, white 100%);
        }

        .template-option-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .template-option-title {
            font-size: 16px;
            font-weight: 700;
            color: #1c3643;
            display: flex;
            align-items: center;
        }

        .template-badge {
            background: #0da1c7;
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .template-badge.default {
            background: #2e7d32;
        }

        .template-option-desc {
            font-size: 13px;
            color: #687F8B;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .template-option-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #687F8B;
        }

        .radio-circle {
            width: 20px;
            height: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 50%;
            display: inline-block;
            position: relative;
            margin-right: 8px;
            vertical-align: middle;
            flex-shrink: 0;
        }

        .template-option.selected .radio-circle {
            border-color: #0da1c7;
        }

        .template-option.selected .radio-circle::after {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #0da1c7;
        }

        .preview-section {
            margin-top: 32px;
            padding: 24px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .preview-title {
            font-size: 14px;
            font-weight: 700;
            color: #1c3643;
            margin-bottom: 16px;
        }

        .preview-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .preview-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #687F8B;
        }

        .preview-item.enabled {
            color: #1c3643;
        }

        .preview-item .check {
            color: #2e7d32;
            font-weight: 700;
        }

        .preview-item .cross {
            color: #687F8B;
            font-weight: 700;
        }

        .wizard-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 32px;
        }

        .action-button {
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .action-button:hover {
            opacity: 0.85;
        }

        .action-button-secondary {
            background-color: #e0e0e0;
            color: #687F8B;
        }
    </style>
</head>
<body>
    <!-- UNIFIED NAVIGATION COMPONENT -->
    <style>.unified-navbar{background:url(https://app.harkenbov.com/assets/img/accent-white-bright.png) top left/contain #1c3643;background-color:#1c3643!important;height:84px;color:#fff;display:flex;align-items:center;justify-content:space-between;padding:0 32px;box-shadow:0 2px 8px rgba(0,0,0,0.1);position:sticky;top:0;z-index:1000}.nav-logo{height:40px;width:auto;cursor:pointer}.nav-center{display:flex;align-items:center;gap:8px;flex:1;justify-content:center}.nav-core-features{display:flex;align-items:center;gap:4px;background:rgba(13, 161, 199, 0.08);border-radius:25px;padding:4px 8px;margin-right:16px}.nav-link{color:white;text-decoration:none;padding:10px 20px;border-radius:25px;transition:all 0.2s;border:1px solid transparent;font-weight:500;font-size:14px;white-space:nowrap}.nav-link:hover{background-color:rgba(255,255,255,0.08)}.nav-link.core-feature{font-weight:500;font-size:14px;color:white}.nav-link.core-feature:hover{background-color:rgba(13, 161, 199, 0.2);color:white}.nav-link.core-feature.active{background-color:transparent;border:1px solid #0da1c7;color:#0da1c7;box-shadow:0 2px 4px rgba(13, 161, 199, 0.2)}.nav-link.active{background-color:transparent;border:1px solid #0da1c7;color:#0da1c7}.nav-separator{width:1px;height:24px;background:rgba(255, 255, 255, 0.2);margin:0 8px}.nav-user{display:flex;align-items:center;gap:12px}.nav-user-name{font-size:14px;font-weight:500;color:white}.nav-user-avatar{width:36px;height:36px;border-radius:50%;border:2px solid #0da1c7}</style><nav class="unified-navbar"><img src="harken.png" alt="Harken CRE" class="nav-logo" onclick="window.location.href='SuperAdmin/super-admin-dashboard.html'"><div class="nav-center"><div class="nav-core-features"><a href="super-admin-comps.html" class="nav-link core-feature active" id="nav-comps">COMPS</a><a href="super-admin-appraisals-list.html" class="nav-link core-feature" id="nav-appraisals">APPRAISAL</a><a href="super-admin-evaluations-list.html" class="nav-link core-feature" id="nav-evaluations">EVALUATION</a></div><div class="nav-separator"></div><a href="super-admin-dashboard.html" class="nav-link" id="nav-dashboard">Dashboard</a><a href="super-admin-users.html" class="nav-link" id="nav-users">Users</a><a href="super-admin-clients.html" class="nav-link" id="nav-clients">Clients</a><a href="super-admin-accounts.html" class="nav-link" id="nav-accounts">Accounts</a><a href="super-admin-reports.html" class="nav-link" id="nav-reports">Reports</a><a href="super-admin-support-tickets.html" class="nav-link" id="nav-support">Support</a><a href="super-admin-audit-logs.html" class="nav-link" id="nav-audit">Audit Logs</a><a href="super-admin-settings.html" class="nav-link" id="nav-settings">Settings</a></div><div class="nav-user"><span class="nav-user-name">Harken Admin</span><img src="https://i.pravatar.cc/150?img=33" alt="User" class="nav-user-avatar"></div></nav>

    <!-- Comp Type Tabs -->
    <div class="comp-tabs" id="compTabs">
        <button class="comp-tab active" data-type="commercial" onclick="switchCompType('commercial')">
            <i class="material-icons" style="font-size: 18px;">business</i>
            Commercial
        </button>
        <button class="comp-tab" data-type="residential" onclick="switchCompType('residential')">
            <i class="material-icons" style="font-size: 18px;">home</i>
            Residential
        </button>
        <button class="comp-tab" data-type="land" onclick="switchCompType('land')">
            <i class="material-icons" style="font-size: 18px;">terrain</i>
            Land
        </button>
    </div>

    <!-- Control Bar -->
    <div class="control-bar" id="compsControlBar">
        <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
            <div class="search-container">
                <i class="material-icons">search</i>
                <input type="text" class="search-input" placeholder="Search Comps" style="width: 280px;" oninput="handleSearch(this.value)">
            </div>
            
            <!-- Lease/Sale Toggle -->
            <div class="toggle-group">
                <button class="toggle-radio" onclick="toggleType('lease')" id="leaseToggle">Lease</button>
                <button class="toggle-radio active" onclick="toggleType('sale')" id="saleToggle">Sale</button>
            </div>

            <!-- Premium Multi-select Status -->
            <div class="multi-select" id="statusMultiSelect">
                <button class="multi-select-button" onclick="toggleDropdown('statusDropdown', 'statusMultiSelect')">
                    <span class="multi-select-label" id="statusLabel">Sale Status</span>
                </button>
                <div id="statusDropdown" class="multi-select-dropdown">
                    <div class="multi-select-option" id="option-status-active" onclick="toggleStatusOption('active')">
                        <span>Active</span>
                    </div>
                    <div class="multi-select-option" id="option-status-sold" onclick="toggleStatusOption('sold')">
                        <span>Sold</span>
                    </div>
                    <div class="multi-select-option" id="option-status-pending" onclick="toggleStatusOption('pending')">
                        <span>Pending</span>
                    </div>
                </div>
            </div>

            <!-- Premium Multi-select Type -->
            <div class="multi-select" id="typeMultiSelect">
                <button class="multi-select-button" onclick="toggleDropdown('typeDropdown', 'typeMultiSelect')">
                    <span class="multi-select-label" id="typeLabel">Property Type</span>
                </button>
                <div id="typeDropdown" class="multi-select-dropdown">
                    <div class="multi-select-option" id="option-type-office" onclick="toggleTypeOption('office')">
                        <span>Office</span>
                    </div>
                    <div class="multi-select-option" id="option-type-retail" onclick="toggleTypeOption('retail')">
                        <span>Retail</span>
                    </div>
                    <div class="multi-select-option" id="option-type-industrial" onclick="toggleTypeOption('industrial')">
                        <span>Industrial</span>
                    </div>
                    <div class="multi-select-option" id="option-type-hospitality" onclick="toggleTypeOption('hospitality')">
                        <span>Hospitality</span>
                    </div>
                </div>
            </div>

            <select class="filter-select" onchange="sortProperties(this.value)">
                <option value="">Sort By</option>
                <option value="price-desc">Price (High to Low)</option>
                <option value="price-asc">Price (Low to High)</option>
                <option value="date-desc">Date (Newest)</option>
                <option value="sf-desc">Building SF (Large to Small)</option>
            </select>

            <button class="btn-filters" onclick="openFiltersModal()">
                <i class="material-icons" style="font-size: 16px;">filter_list</i>
                Filters
            </button>
        </div>

        <div style="display: flex; gap: 12px; align-items: center;">
            <button class="btn-primary" onclick="openUploadModal()">
                <i class="material-icons" style="font-size: 18px;">upload</i>
                Upload
            </button>
            <a href="comps-create-full-page.html" class="btn-primary" style="display: inline-flex; align-items: center; gap: 6px; text-decoration: none;">
                <i class="material-icons" style="font-size: 18px;">add</i>
                Add New
            </a>
        </div>
    </div>

    <!-- Filter Tags Container -->
    <div class="filter-tags-container" id="compsFilterTags" style="padding: 12px 24px; display: flex; justify-content: space-between; align-items: center;">
        <div style="display: flex; align-items: center; gap: 8px;">
            <span class="filter-tags-label">Active Filters:</span>
            <div id="allFilterTags" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
        </div>
        <div style="display: flex; align-items: center; gap: 16px; width: 420px; padding-left: 50px; padding-top: 16px; padding-bottom: 12px;">
            <span style="color: #0da1c7; font-weight: 700; font-size: 13px; cursor: pointer;" onclick="selectAllProperties()">Select All</span>
            <div style="display: flex; align-items: center; gap: 16px; margin-left: auto; padding-right: 16px;">
                <span style="font-size: 12px; color: #687F8B; font-weight: 500;">Showing <span id="displayedCount">0</span> to <span id="displayedMax">0</span> of <span id="totalCountTop">0</span> entries</span>
                <div class="print-with-count" style="display: flex; align-items: center; cursor: pointer;" onclick="window.print()">
                    <span class="material-icons" style="color: #0da1c7; font-size: 20px;">print</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Split View -->
    <div class="split-container" id="compsSplitContainer">
        <!-- Map Section -->
        <div class="map-section">
            <div id="map">
                <!-- Price Clusters -->
                <div class="map-pin" style="top: 35%; left: 75%;">
                    <div class="price-label">$6.3M</div>
                    <div class="map-popup" style="left: -140px; top: 35px; min-width: 280px; position: relative;">
                        <div class="selection-checkbox-container" onclick="event.stopPropagation(); togglePropertySelection(1, event)">
                            <input type="checkbox" class="selection-checkbox">
                        </div>
                        <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400" class="popup-image">
                        <div class="popup-title">78 D'Amante Drive <span class="popup-status status-active">Active</span></div>
                        <div class="popup-address">Concord, NH, 3301</div>
                        <div class="popup-content">
                            <div class="popup-left">
                                <div class="popup-info"><span class="popup-label">Year Built/Remodeled :</span> 2000 / N/A</div>
                                <div class="popup-info"><span class="popup-label">Type :</span> Retail</div>
                                <div class="popup-info"><span class="popup-label">Building Size :</span> 31,420 SF</div>
                                <div class="popup-info"><span class="popup-label">Land Size :</span> 110,207 SF</div>
                            </div>
                            <div class="popup-right">
                                <div class="popup-info"><span class="popup-label">Sale Price :</span> $6,300,000.00</div>
                                <div class="popup-info"><span class="popup-label">$/SF :</span> $200.51</div>
                                <div class="popup-info"><span class="popup-label">Condition :</span> Good</div>
                            </div>
                        </div>
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-view" onclick="viewPropertyDetail(1)">View</button>
                            <button class="popup-btn popup-btn-edit" onclick="editProperty(1)">Edit</button>
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 68%; left: 25%;">
                    <div class="price-label">$7.5M</div>
                    <div class="map-popup" style="left: -140px; top: 35px; min-width: 280px; position: relative;">
                        <div class="selection-checkbox-container" onclick="event.stopPropagation(); togglePropertySelection(2, event)">
                            <input type="checkbox" class="selection-checkbox">
                        </div>
                        <img src="https://images.unsplash.com/photo-1565008576549-57569a49371d?w=400" class="popup-image">
                        <div class="popup-title">Industrial Complex <span class="popup-status status-active">Active</span></div>
                        <div class="popup-address">Los Angeles, CA, 90001</div>
                        <div class="popup-content">
                            <div class="popup-left">
                                <div class="popup-info"><span class="popup-label">Year Built/Remodeled :</span> 2010</div>
                                <div class="popup-info"><span class="popup-label">Type :</span> Industrial</div>
                                <div class="popup-info"><span class="popup-label">Building Size :</span> 42,000 SF</div>
                                <div class="popup-info"><span class="popup-label">Land Size :</span> 65,000 SF</div>
                            </div>
                            <div class="popup-right">
                                <div class="popup-info"><span class="popup-label">Sale Price :</span> $7,500,000.00</div>
                                <div class="popup-info"><span class="popup-label">$/SF :</span> $178.57</div>
                                <div class="popup-info"><span class="popup-label">Condition :</span> Good</div>
                            </div>
                        </div>
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-view" onclick="viewPropertyDetail(5)">View</button>
                            <button class="popup-btn popup-btn-edit" onclick="editProperty(5)">Edit</button>
                        </div>
                    </div>
                </div>

                <!-- Pin Clusters -->
                <div class="map-pin" style="top: 45%; left: 15%;">
                    <div class="pin-cluster">15</div>
                    <div class="map-popup" style="left: -80px; top: 60px;">
                        <div class="popup-title">California Region</div>
                        <div class="popup-address">15 Properties</div>
                        <div class="popup-details">
                            <strong>Total Value:</strong> $128M<br>
                            <strong>Avg Price:</strong> $8.5M<br>
                            <strong>Property Types:</strong> Mixed
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 38%; left: 48%;">
                    <div class="pin-cluster">86</div>
                    <div class="map-popup" style="left: -80px; top: 60px;">
                        <div class="popup-title">Midwest Region</div>
                        <div class="popup-address">86 Properties</div>
                        <div class="popup-details">
                            <strong>Total Value:</strong> $245M<br>
                            <strong>Avg Price:</strong> $2.8M<br>
                            <strong>Property Types:</strong> Mixed
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 50%; left: 55%;">
                    <div class="pin-cluster">12</div>
                    <div class="map-popup" style="left: -80px; top: 60px;">
                        <div class="popup-title">Illinois Region</div>
                        <div class="popup-address">12 Properties</div>
                        <div class="popup-details">
                            <strong>Total Value:</strong> $45M<br>
                            <strong>Avg Price:</strong> $3.75M<br>
                            <strong>Property Types:</strong> Office, Retail
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 32%; left: 82%;">
                    <div class="pin-cluster">5</div>
                    <div class="map-popup" style="left: -80px; top: 60px;">
                        <div class="popup-title">Northeast Region</div>
                        <div class="popup-address">5 Properties</div>
                        <div class="popup-details">
                            <strong>Total Value:</strong> $32M<br>
                            <strong>Avg Price:</strong> $6.4M<br>
                            <strong>Property Types:</strong> Office
                        </div>
                    </div>
                </div>

                <!-- Individual Pins -->
                <div class="map-pin" style="top: 42%; left: 78%;">
                    <div class="pin-marker">1</div>
                    <div class="map-popup" style="left: -140px; top: 50px; min-width: 280px; position: relative;">
                        <div class="selection-checkbox-container" onclick="event.stopPropagation(); togglePropertySelection(3, event)">
                            <input type="checkbox" class="selection-checkbox">
                        </div>
                        <img src="https://images.unsplash.com/photo-1497366216548-37526070297c?w=400" class="popup-image">
                        <div class="popup-title">229 South 6th Street <span class="popup-status status-active">Active</span></div>
                        <div class="popup-address">Missouri Valley, IA, 51555</div>
                        <div class="popup-content">
                            <div class="popup-left">
                                <div class="popup-info"><span class="popup-label">Year Built/Remodeled :</span> 1970 / N/A</div>
                                <div class="popup-info"><span class="popup-label">Type :</span> Retail</div>
                                <div class="popup-info"><span class="popup-label">Building Size :</span> 11,158 SF</div>
                                <div class="popup-info"><span class="popup-label">Land Size :</span> 42,476 SF</div>
                            </div>
                            <div class="popup-right">
                                <div class="popup-info"><span class="popup-label">Sale Price :</span> $165,000.00</div>
                                <div class="popup-info"><span class="popup-label">$/SF :</span> $14.79</div>
                                <div class="popup-info"><span class="popup-label">Condition :</span> Average</div>
                            </div>
                        </div>
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-view" onclick="viewPropertyDetail(2)">View</button>
                            <button class="popup-btn popup-btn-edit" onclick="editProperty(2)">Edit</button>
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 25%; left: 22%;">
                    <div class="pin-marker">1</div>
                    <div class="map-popup" style="left: -140px; top: 50px; min-width: 280px; position: relative;">
                        <div class="selection-checkbox-container" onclick="event.stopPropagation(); togglePropertySelection(4, event)">
                            <input type="checkbox" class="selection-checkbox">
                        </div>
                        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400" class="popup-image">
                        <div class="popup-title">Gallatin Road <span class="popup-status status-active">Active</span></div>
                        <div class="popup-address">Gallatin Gateway, MT, 59730</div>
                        <div class="popup-content">
                            <div class="popup-left">
                                <div class="popup-info"><span class="popup-label">Year Built/Remodeled :</span> N/A</div>
                                <div class="popup-info"><span class="popup-label">Type :</span> Hospitality</div>
                                <div class="popup-info"><span class="popup-label">Building Size :</span> 2,827 SF</div>
                                <div class="popup-info"><span class="popup-label">Land Size :</span> 198,503 SF</div>
                            </div>
                            <div class="popup-right">
                                <div class="popup-info"><span class="popup-label">Sale Price :</span> $3,999,000.00</div>
                                <div class="popup-info"><span class="popup-label">$/SF :</span> $1,414.57</div>
                                <div class="popup-info"><span class="popup-label">Condition :</span> Good</div>
                            </div>
                        </div>
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-view" onclick="viewPropertyDetail(3)">View</button>
                            <button class="popup-btn popup-btn-edit" onclick="editProperty(3)">Edit</button>
                        </div>
                    </div>
                </div>

                <div class="map-pin" style="top: 58%; left: 70%;">
                    <div class="pin-marker">1</div>
                    <div class="map-popup" style="left: -140px; top: 50px; min-width: 280px;">
                        <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400" class="popup-image">
                        <div class="popup-title">317 East 4th Street <span class="popup-status status-active">Active</span></div>
                        <div class="popup-address">Dell Rapids, SD, 57022</div>
                        <div class="popup-content">
                            <div class="popup-left">
                                <div class="popup-info"><span class="popup-label">Year Built/Remodeled :</span> 1976 / N/A</div>
                                <div class="popup-info"><span class="popup-label">Type :</span> Office</div>
                                <div class="popup-info"><span class="popup-label">Building Size :</span> 9,283 SF</div>
                                <div class="popup-info"><span class="popup-label">Land Size :</span> 10,000 SF</div>
                            </div>
                            <div class="popup-right">
                                <div class="popup-info"><span class="popup-label">Sale Price :</span> $700,000.00</div>
                                <div class="popup-info"><span class="popup-label">$/SF :</span> $75.30</div>
                                <div class="popup-info"><span class="popup-label">Condition :</span> Good</div>
                            </div>
                        </div>
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-view" onclick="viewPropertyDetail(1)">View</button>
                            <button class="popup-btn popup-btn-edit" onclick="editProperty(1)">Edit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- List Section -->
        <div class="list-section" id="listContainer">
            <!-- Properties will be loaded here -->
        </div>
    </div>

    <!-- Evaluation List Container -->
    <div id="evaluationContainer">
        <div class="evaluation-header">
            <h1 class="evaluation-title">EVALUATION LIST</h1>
            <div class="evaluation-search-bar">
                <div class="evaluation-search-container">
                    <i class="material-icons">search</i>
                    <input type="text" class="evaluation-search-input" placeholder="Search Evaluations" oninput="filterEvaluations(this.value)">
                </div>
                <a href="evaluation-wizard-full.html" class="btn-primary" style="display: inline-flex; align-items: center; gap: 6px; text-decoration: none;">
                    <i class="material-icons" style="font-size: 18px;">add</i>
                    Add New
                </a>
            </div>
        </div>

        <div class="evaluation-table-container">
            <table class="evaluation-table">
                <thead>
                    <tr>
                        <th class="sortable">Name â–¼</th>
                        <th>Client</th>
                        <th class="sortable">Address â–¼</th>
                        <th class="sortable">Inspection Date â–¼</th>
                        <th class="sortable">Type â–¼</th>
                        <th>Approaches</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="evaluationTableBody">
                    <tr>
                        <td><a href="#" class="evaluation-link">As Completed</a></td>
                        <td>Zabrina Miller</td>
                        <td></td>
                        <td>N/A</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(1)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(1)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(1)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">As Completed</a></td>
                        <td>Chantelle Thomas</td>
                        <td>3752 Valley Drive</td>
                        <td>07/06/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                                <span class="approach-badge approach-income">I</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(2)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(2)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(2)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">As Is</a></td>
                        <td>Chantelle Thomas</td>
                        <td>3752 Valley Drive</td>
                        <td>07/06/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                                <span class="approach-badge approach-income">I</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(3)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(3)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(3)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">6508 South Frontage Road</a></td>
                        <td>Udo NA</td>
                        <td>6508 South Frontage Road</td>
                        <td>07/03/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(4)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(4)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(4)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">800 East 6th Avenue</a></td>
                        <td>Gina Wilhelm</td>
                        <td>800 East 6th Avenue</td>
                        <td>07/03/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(5)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(5)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(5)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">3109 Peregrine Lane</a></td>
                        <td>Carsen Mayer</td>
                        <td>3109 Peregrine Lane</td>
                        <td>07/03/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(6)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(6)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(6)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">5 & 7 Wonder Road</a></td>
                        <td>Felicity Riggin</td>
                        <td>5 & 7 Wonder Road</td>
                        <td>07/02/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(7)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(7)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(7)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">Shop World 406 Subdivision, Lot 27 & 28</a></td>
                        <td>Kai Helyer</td>
                        <td>Shop World 406 Subdivision, Lot 27 & 28</td>
                        <td>07/02/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(8)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(8)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(8)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">101 South 3rd Street West</a></td>
                        <td>Evaluation Review</td>
                        <td>101 South 3rd Street West</td>
                        <td>07/01/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(9)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(9)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(9)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="#" class="evaluation-link">1335 U.S. Highway 93 W</a></td>
                        <td>Terry Driscoll</td>
                        <td>1335 U.S. Highway 93 W</td>
                        <td>07/01/2025</td>
                        <td>Building(s) with Land</td>
                        <td>
                            <div class="approaches-container">
                                <span class="approach-badge approach-sales">S</span>
                            </div>
                        </td>
                        <td>
                            <div class="evaluation-actions">
                                <button class="evaluation-action-btn edit" data-tooltip="Edit" onclick="editEvaluation(10)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button class="evaluation-action-btn delete" data-tooltip="Delete" onclick="deleteEvaluation(10)">
                                    <i class="material-icons">delete</i>
                                </button>
                                <button class="evaluation-action-btn pdf" data-tooltip="Download PDF" onclick="downloadPDF(10)">
                                    <i class="material-icons">picture_as_pdf</i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Pagination -->
            <div class="pagination">
                <button class="pagination-btn" onclick="goToPage('prev')" id="prevBtn">
                    <span class="material-icons" style="font-size: 16px;">chevron_left</span>
                </button>
                <span style="color: #687F8B; font-size: 13px; font-weight: 500; margin: 0 8px;">Previous</span>
                
                <button class="pagination-btn active" onclick="goToPage(1)">1</button>
                <button class="pagination-btn" onclick="goToPage(2)">2</button>
                <button class="pagination-btn" onclick="goToPage(3)">3</button>
                <button class="pagination-btn" onclick="goToPage(4)">4</button>
                <button class="pagination-btn" onclick="goToPage(5)">5</button>
                <span style="color: #687F8B; margin: 0 4px;">...</span>
                <button class="pagination-btn" onclick="goToPage(184)">184</button>
                
                <span style="color: #687F8B; font-size: 13px; font-weight: 500; margin: 0 8px;">Next</span>
                <button class="pagination-btn" onclick="goToPage('next')" id="nextBtn">
                    <span class="material-icons" style="font-size: 16px;">chevron_right</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced property data matching your exact structure
        const properties = [
            // COMMERCIAL PROPERTIES
            {
                id: 1,
                address: '317 East 4th Street',
                status: 'Active',
                city: 'Dell Rapids',
                state: 'SD',
                zipcode: '57022',
                lat: 43.8253,
                lng: -96.7111,
                type: 'Office',
                property_category: 'commercial',
                buildingSize: 9283,
                landSize: 10000,
                salePrice: 700000,
                pricePerSF: 75.30,
                condition: 'Good',
                yearBuilt: 1976,
                image: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400'
            },
            {
                id: 2,
                address: '229 South 6th Street',
                status: 'Active',
                city: 'Missouri Valley',
                state: 'IA',
                zipcode: '51555',
                lat: 41.5583,
                lng: -95.8888,
                type: 'Retail',
                property_category: 'commercial',
                buildingSize: 11158,
                landSize: 42476,
                salePrice: 165000,
                pricePerSF: 14.79,
                condition: 'Average',
                yearBuilt: 1970,
                image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?w=400'
            },
            {
                id: 3,
                address: 'Gallatin Road',
                status: 'Active',
                city: 'Gallatin Gateway',
                state: 'MT',
                zipcode: '59730',
                lat: 45.6780,
                lng: -111.2230,
                type: 'Hospitality',
                property_category: 'commercial',
                buildingSize: 2827,
                landSize: 198503,
                salePrice: 3999000,
                pricePerSF: 1414.57,
                condition: 'Good',
                yearBuilt: null,
                image: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400'
            },
            {
                id: 4,
                address: '123 Commerce Street',
                status: 'Active',
                city: 'Chicago',
                state: 'IL',
                zipcode: '60601',
                lat: 41.8781,
                lng: -87.6298,
                type: 'Office',
                property_category: 'commercial',
                buildingSize: 15000,
                landSize: 8000,
                salePrice: 2100000,
                pricePerSF: 140.00,
                condition: 'Excellent',
                yearBuilt: 2015,
                image: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400'
            },
            {
                id: 5,
                address: '456 Industrial Blvd',
                status: 'Sold',
                city: 'Los Angeles',
                state: 'CA',
                zipcode: '90001',
                lat: 34.0522,
                lng: -118.2437,
                type: 'Industrial',
                property_category: 'commercial',
                buildingSize: 42000,
                landSize: 65000,
                salePrice: 6300000,
                pricePerSF: 150.00,
                condition: 'Good',
                yearBuilt: 2010,
                image: 'https://images.unsplash.com/photo-1565008576549-57569a49371d?w=400'
            },

            // RESIDENTIAL PROPERTIES
            {
                id: 101,
                address: '2450 Mountain View Drive',
                status: 'Active',
                city: 'Denver',
                state: 'CO',
                zipcode: '80202',
                lat: 39.7392,
                lng: -104.9903,
                type: 'Single Family',
                property_category: 'residential',
                buildingSize: 2400,
                landSize: 8000,
                salePrice: 625000,
                pricePerSF: 260.42,
                condition: 'Excellent',
                yearBuilt: 2020,
                bedrooms: 4,
                bathrooms: 3.5,
                image: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=400'
            },
            {
                id: 102,
                address: '1850 Riverside Lane',
                status: 'Sold',
                city: 'Boulder',
                state: 'CO',
                zipcode: '80302',
                lat: 40.0150,
                lng: -105.2705,
                type: 'Single Family',
                property_category: 'residential',
                buildingSize: 2000,
                landSize: 7200,
                salePrice: 485000,
                pricePerSF: 242.50,
                condition: 'Good',
                yearBuilt: 2015,
                bedrooms: 3,
                bathrooms: 2.5,
                image: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400'
            },
            {
                id: 103,
                address: '3200 Cherry Creek #405',
                status: 'Active',
                city: 'Denver',
                state: 'CO',
                zipcode: '80209',
                lat: 39.7265,
                lng: -104.9522,
                type: 'Condo',
                property_category: 'residential',
                buildingSize: 1400,
                landSize: 0,
                salePrice: 425000,
                pricePerSF: 303.57,
                condition: 'Excellent',
                yearBuilt: 2021,
                bedrooms: 2,
                bathrooms: 2,
                image: 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400'
            },
            {
                id: 104,
                address: '825 Victorian Street',
                status: 'Active',
                city: 'Fort Collins',
                state: 'CO',
                zipcode: '80521',
                lat: 40.5853,
                lng: -105.0844,
                type: 'Single Family',
                property_category: 'residential',
                buildingSize: 1600,
                landSize: 6000,
                salePrice: 395000,
                pricePerSF: 246.88,
                condition: 'Average',
                yearBuilt: 1925,
                bedrooms: 3,
                bathrooms: 2,
                image: 'https://images.unsplash.com/photo-1601760562234-9814eea6663a?w=400'
            },

            // LAND PROPERTIES
            {
                id: 201,
                address: 'Lot 23, Mountain Ridge Estates',
                status: 'Active',
                city: 'Parker',
                state: 'CO',
                zipcode: '80134',
                lat: 39.5186,
                lng: -104.7614,
                type: 'Residential Lot',
                property_category: 'land',
                buildingSize: 0,
                landSize: 30000,
                salePrice: 165000,
                pricePerSF: 5.50,
                condition: 'N/A',
                yearBuilt: null,
                image: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400'
            },
            {
                id: 202,
                address: 'Highway 85 & Main Street',
                status: 'Active',
                city: 'Littleton',
                state: 'CO',
                zipcode: '80120',
                lat: 39.6133,
                lng: -105.0166,
                type: 'Commercial Land',
                property_category: 'land',
                buildingSize: 0,
                landSize: 87120,
                salePrice: 875000,
                pricePerSF: 10.05,
                condition: 'N/A',
                yearBuilt: null,
                image: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400'
            },
            {
                id: 203,
                address: '15800 County Road 47',
                status: 'Sold',
                city: 'Castle Rock',
                state: 'CO',
                zipcode: '80104',
                lat: 39.3722,
                lng: -104.8561,
                type: 'Ranch Land',
                property_category: 'land',
                buildingSize: 0,
                landSize: 871200,
                salePrice: 1250000,
                pricePerSF: 1.43,
                condition: 'N/A',
                yearBuilt: null,
                image: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400'
            },
            {
                id: 204,
                address: 'Mountain Vista Drive',
                status: 'Active',
                city: 'Evergreen',
                state: 'CO',
                zipcode: '80439',
                lat: 39.6333,
                lng: -105.3167,
                type: 'Mountain Lot',
                property_category: 'land',
                buildingSize: 0,
                landSize: 43560,
                salePrice: 185000,
                pricePerSF: 4.25,
                condition: 'N/A',
                yearBuilt: null,
                image: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400'
            }
        ];

        let map;
        let markers = [];
        let markerClusterer;
        let infoWindows = [];
        let currentInfoWindow = null;
        
        // Initialize filteredProperties with property category filter
        const activePropertyCategory = localStorage.getItem('activeCompType') || 'commercial';
        let filteredProperties = properties.filter(p => p.property_category === activePropertyCategory);
        
        let activePropertyId = null;
        let selectedPropertyIds = new Set(); // Track selected properties

        // Toggle property selection
        function togglePropertySelection(propertyId, event) {
            if (event) {
                event.stopPropagation();
            }
            
            if (selectedPropertyIds.has(propertyId)) {
                selectedPropertyIds.delete(propertyId);
            } else {
                selectedPropertyIds.add(propertyId);
            }
            
            updateSelectionCount();
            renderList(); // Re-render to update checkboxes
        }

        // Select all visible properties
        function selectAllProperties() {
            const visibleProperties = filteredProperties.slice(0, 10);
            const allSelected = visibleProperties.every(p => selectedPropertyIds.has(p.id));
            
            if (allSelected) {
                // Deselect all
                visibleProperties.forEach(p => selectedPropertyIds.delete(p.id));
            } else {
                // Select all
                visibleProperties.forEach(p => selectedPropertyIds.add(p.id));
            }
            
            updateSelectionCount();
            renderList();
        }

        // Update selection count badge
        function updateSelectionCount() {
            const count = selectedPropertyIds.size;
            const printButtons = document.querySelectorAll('.print-with-count');
            
            console.log('Updating selection count:', count);
            console.log('Found print buttons:', printButtons.length);
            
            printButtons.forEach(btn => {
                const badge = btn.querySelector('.selection-count-badge');
                if (count > 0) {
                    if (badge) {
                        badge.textContent = `(${count})`;
                        console.log('Updated existing badge');
                    } else {
                        btn.insertAdjacentHTML('beforeend', `<span class="selection-count-badge">(${count})</span>`);
                        console.log('Created new badge');
                    }
                } else {
                    if (badge) {
                        badge.remove();
                        console.log('Removed badge');
                    }
                }
            });
        }

        // Initialize map with clustering
        function initMap() {
            console.log('Initializing map...');
            const mapElement = document.getElementById('map');
            console.log('Map element:', mapElement);
            
            if (!mapElement) {
                console.error('Map element not found!');
                return;
            }

            try {
                map = new google.maps.Map(mapElement, {
                    center: { lat: 39.8283, lng: -98.5795 },
                    zoom: 4,
                    styles: [
                        {
                            featureType: 'poi',
                            elementType: 'labels',
                            stylers: [{ visibility: 'off' }]
                        }
                    ],
                    mapTypeControl: true,
                    fullscreenControl: false,
                    streetViewControl: true
                });

                console.log('Map created successfully');
                
                // Wait for map to be ready
                google.maps.event.addListenerOnce(map, 'idle', function() {
                    console.log('Map is ready');
                    renderProperties();
                });
            } catch (error) {
                console.error('Error creating map:', error);
            }
        }

        // Render properties on map and list
        function renderProperties() {
            console.log('Rendering properties...');
            console.log('Filtered properties count:', filteredProperties.length);
            
            // Clear existing markers
            if (markerClusterer) {
                markerClusterer.clearMarkers();
            }
            markers.forEach(marker => marker.setMap(null));
            markers = [];
            infoWindows = [];

            // Create markers
            filteredProperties.forEach(property => {
                const marker = createMarker(property);
                markers.push(marker);
            });
            
            console.log('Created markers:', markers.length);

            // Create clusterer with custom styling
            if (window.markerClusterer && window.markerClusterer.MarkerClusterer) {
                markerClusterer = new markerClusterer.MarkerClusterer({ 
                    map,
                    markers,
                    renderer: {
                        render: ({ count, position }) => {
                            return new google.maps.Marker({
                                position,
                                icon: {
                                    url: `data:image/svg+xml;charset=UTF-8,${encodeURIComponent(`
                                        <svg width="50" height="50" xmlns="http://www.w3.org/2000/svg">
                                            <circle cx="25" cy="25" r="23" fill="#0da1c7" stroke="white" stroke-width="3"/>
                                            <text x="25" y="30" text-anchor="middle" font-family="Montserrat, Arial" font-size="14" font-weight="700" fill="white">${count}</text>
                                        </svg>
                                    `)}`,
                                    scaledSize: new google.maps.Size(50, 50)
                                },
                                label: null
                            });
                        }
                    }
                });
            } else {
                // Fallback: just show markers without clustering
                markers.forEach(marker => marker.setMap(map));
            }

            // Render list
            renderList();
        }

        // Create marker
        function createMarker(property) {
            const marker = new google.maps.Marker({
                position: { lat: property.lat, lng: property.lng },
                map: null, // Will be added by clusterer
                title: property.address,
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 8,
                    fillColor: '#0da1c7',
                    fillOpacity: 1,
                    strokeColor: '#ffffff',
                    strokeWeight: 2
                }
            });

            const infoWindow = new google.maps.InfoWindow({
                content: createInfoWindowContent(property)
            });

            marker.addListener('click', () => {
                if (currentInfoWindow) {
                    currentInfoWindow.close();
                }
                infoWindow.open(map, marker);
                currentInfoWindow = infoWindow;
                setActiveProperty(property.id);
                scrollToProperty(property.id);
            });

            infoWindows.push(infoWindow);
            return marker;
        }

        // Create info window content
        function createInfoWindowContent(property) {
            return `
                <div class="custom-info-window">
                    <img src="${property.image}" class="info-image" onerror="this.src='https://via.placeholder.com/280x120?text=Property'">
                    <div class="info-title">${property.address} (${property.status})</div>
                    <div class="info-address">${property.city}, ${property.state} ${property.zipcode}</div>
                    <div class="info-price">${formatCurrency(property.salePrice)}</div>
                    <div class="info-details">
                        <strong>Type:</strong> ${property.type}<br>
                        <strong>Building Size:</strong> ${formatNumber(property.buildingSize)} SF<br>
                        <strong>$/SF:</strong> ${formatCurrency(property.pricePerSF)}<br>
                        <strong>Condition:</strong> ${property.condition}
                    </div>
                    <button class="info-btn" onclick="viewPropertyDetail(${property.id})">View Details</button>
                </div>
            `;
        }

        // Render list with exact card format
        function renderList() {
            const container = document.getElementById('listContainer');
            
            // Update the static header counts
            const displayedMin = filteredProperties.length > 0 ? 1 : 0;
            const displayedMax = Math.min(10, filteredProperties.length);
            const totalCount = filteredProperties.length;
            
            document.getElementById('displayedCount').textContent = displayedMin;
            document.getElementById('displayedMax').textContent = displayedMax;
            document.getElementById('totalCountTop').textContent = totalCount;

            const cardsHtml = filteredProperties.slice(0, 10).map((property) => {
                const statusClass = `status-${property.status.toLowerCase()}`;
                const isSelected = selectedPropertyIds.has(property.id);
                return `
                <div class="property-card ${activePropertyId === property.id ? 'active' : ''}" onclick="selectProperty(${property.id})" style="position: relative;">
                    <div class="selection-checkbox-container" onclick="event.stopPropagation(); togglePropertySelection(${property.id}, event)">
                        <input type="checkbox" class="selection-checkbox" ${isSelected ? 'checked' : ''}>
                    </div>
                    <img src="${property.image}" class="property-image" onerror="this.src='https://via.placeholder.com/400x120?text=Property'">
                    <div class="property-title">
                        ${property.address} 
                        <span class="property-status ${statusClass}">${property.status}</span>
                    </div>
                    <div class="property-address">${property.city}, ${property.state}, ${property.zipcode}</div>
                    
                    <div class="property-content">
                        <div class="property-left">
                            <div class="property-info"><span class="property-label">Year Built/Remodeled :</span> ${property.yearBuilt || 'N/A'}</div>
                            <div class="property-info"><span class="property-label">Type :</span> ${property.type}</div>
                            <div class="property-info"><span class="property-label">Building Size :</span> ${formatNumber(property.buildingSize)} SF</div>
                            <div class="property-info"><span class="property-label">Land Size :</span> ${formatNumber(property.landSize)} SF</div>
                        </div>
                        <div class="property-right">
                            <div class="property-info"><span class="property-label">Sale Price :</span> ${formatCurrency(property.salePrice)}</div>
                            <div class="property-info"><span class="property-label">$/SF :</span> ${formatCurrency(property.pricePerSF)}</div>
                            <div class="property-info"><span class="property-label">Condition :</span> ${property.condition}</div>
                        </div>
                    </div>
                    
                    <div class="card-actions-overlay">
                        <button class="action-icon" data-tooltip="View Details" onclick="event.stopPropagation(); viewPropertyDetail(${property.id})">
                            <i class="material-icons">visibility</i>
                        </button>
                        <button class="action-icon" data-tooltip="Edit" onclick="event.stopPropagation(); editProperty(${property.id})">
                            <i class="material-icons">edit</i>
                        </button>
                        <button class="action-icon action-delete" data-tooltip="Delete" onclick="event.stopPropagation(); deleteProperty(${property.id})">
                            <i class="material-icons">delete</i>
                        </button>
                    </div>
                </div>
            `;
            }).join('');

            const paginationHtml = `
                <div class="pagination">
                    <button class="page-btn" onclick="changePage('prev')">Previous</button>
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn">...</button>
                    <button class="page-btn">299</button>
                    <button class="page-btn" onclick="changePage('next')">Next</button>
                </div>
            `;

            container.innerHTML = cardsHtml + paginationHtml;
            updateSelectionCount(); // Update the count after rendering
        }

        // Select property
        function selectProperty(id) {
            // Use viewPropertyDetail to navigate to the correct detail page based on property type
            viewPropertyDetail(id);
        }

        // Set active property
        function setActiveProperty(id) {
            activePropertyId = id;
            renderList();
        }

        // Scroll to property in list
        function scrollToProperty(id) {
            const card = document.querySelector(`.property-card[onclick*="${id}"]`);
            if (card) {
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Format currency
        function formatCurrency(value) {
            if (!value) return '-';
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(value);
        }

        // Format number
        function formatNumber(value) {
            if (!value) return '-';
            return new Intl.NumberFormat('en-US').format(value);
        }

        // Filter functions
        let selectedStatuses = [];
        let selectedTypes = [];

        // Toggle dropdown visibility
        function toggleDropdown(dropdownId, selectId) {
            const dropdown = document.getElementById(dropdownId);
            const selectElement = document.getElementById(selectId);
            const allDropdowns = document.querySelectorAll('.multi-select-dropdown');
            const allSelects = document.querySelectorAll('.multi-select');
            
            allDropdowns.forEach(d => {
                if (d.id !== dropdownId) d.classList.remove('show');
            });
            
            allSelects.forEach(s => {
                if (s.id !== selectId) s.classList.remove('open');
            });
            
            dropdown.classList.toggle('show');
            selectElement.classList.toggle('open');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.multi-select')) {
                document.querySelectorAll('.multi-select-dropdown').forEach(d => d.classList.remove('show'));
                document.querySelectorAll('.multi-select').forEach(s => s.classList.remove('open'));
            }
        });

        // Toggle status option
        function toggleStatusOption(status) {
            const option = document.getElementById('option-status-' + status);
            
            if (selectedStatuses.includes(status)) {
                selectedStatuses = selectedStatuses.filter(s => s !== status);
                option.classList.remove('selected');
            } else {
                selectedStatuses.push(status);
                option.classList.add('selected');
            }
            
            updateStatusLabel();
            updateAllFilterTags();
            filterMultipleSelections();
        }

        // Toggle type option
        function toggleTypeOption(type) {
            const option = document.getElementById('option-type-' + type);
            
            if (selectedTypes.includes(type)) {
                selectedTypes = selectedTypes.filter(t => t !== type);
                option.classList.remove('selected');
            } else {
                selectedTypes.push(type);
                option.classList.add('selected');
            }
            
            updateTypeLabel();
            updateAllFilterTags();
            filterMultipleSelections();
        }

        // Remove status tag
        function removeStatusTag(status) {
            selectedStatuses = selectedStatuses.filter(s => s !== status);
            const option = document.getElementById('option-status-' + status);
            if (option) option.classList.remove('selected');
            updateStatusLabel();
            updateAllFilterTags();
            filterMultipleSelections();
        }

        // Remove type tag
        function removeTypeTag(type) {
            selectedTypes = selectedTypes.filter(t => t !== type);
            const option = document.getElementById('option-type-' + type);
            if (option) option.classList.remove('selected');
            updateTypeLabel();
            updateAllFilterTags();
            filterMultipleSelections();
        }

        // Update status label
        function updateStatusLabel() {
            const label = document.getElementById('statusLabel');
            if (selectedStatuses.length === 0) {
                label.textContent = 'Sale Status';
            } else if (selectedStatuses.length === 1) {
                label.textContent = selectedStatuses[0].charAt(0).toUpperCase() + selectedStatuses[0].slice(1);
            } else {
                label.textContent = `Sale Status (${selectedStatuses.length})`;
            }
        }

        // Update type label
        function updateTypeLabel() {
            const label = document.getElementById('typeLabel');
            if (selectedTypes.length === 0) {
                label.textContent = 'Property Type';
            } else if (selectedTypes.length === 1) {
                label.textContent = selectedTypes[0].charAt(0).toUpperCase() + selectedTypes[0].slice(1);
            } else {
                label.textContent = `Property Type (${selectedTypes.length})`;
            }
        }

        // Update all filter tags
        function updateAllFilterTags() {
            const container = document.getElementById('allFilterTags');
            const allTags = [];
            
            // Add status tags
            selectedStatuses.forEach(status => {
                allTags.push(`
                    <span class="selection-tag">
                        ${status.charAt(0).toUpperCase() + status.slice(1)}
                        <span class="tag-remove" onclick="removeStatusTag('${status}')">Ã—</span>
                    </span>
                `);
            });
            
            // Add type tags
            selectedTypes.forEach(type => {
                allTags.push(`
                    <span class="selection-tag-type">
                        ${type.charAt(0).toUpperCase() + type.slice(1)}
                        <span class="tag-remove" onclick="removeTypeTag('${type}')">Ã—</span>
                    </span>
                `);
            });
            
            if (allTags.length === 0) {
                container.innerHTML = '<span style="color: #9ca3af; font-size: 12px;">No filters applied</span>';
            } else {
                container.innerHTML = allTags.join('');
            }
        }

        // Filter properties based on multiple selections
        function filterMultipleSelections() {
            // Get active property category from localStorage
            const activePropertyCategory = localStorage.getItem('activePropertyType') || 'commercial';
            
            filteredProperties = properties.filter(property => {
                const statusMatch = selectedStatuses.length === 0 || selectedStatuses.includes(property.status.toLowerCase());
                const typeMatch = selectedTypes.length === 0 || selectedTypes.includes(property.type.toLowerCase());
                const categoryMatch = property.property_category === activePropertyCategory;
                return statusMatch && typeMatch && categoryMatch;
            });
            renderList();
        }

        function filterByStatus(status) {
            const activePropertyCategory = localStorage.getItem('activePropertyType') || 'commercial';
            if (status) {
                filteredProperties = properties.filter(p => 
                    p.status.toLowerCase() === status.toLowerCase() && 
                    p.property_category === activePropertyCategory
                );
            } else {
                filteredProperties = properties.filter(p => p.property_category === activePropertyCategory);
            }
            renderList();
        }

        function filterByType(type) {
            const activePropertyCategory = localStorage.getItem('activePropertyType') || 'commercial';
            if (type) {
                filteredProperties = properties.filter(p => 
                    p.type.toLowerCase() === type.toLowerCase() && 
                    p.property_category === activePropertyCategory
                );
            } else {
                filteredProperties = properties.filter(p => p.property_category === activePropertyCategory);
            }
            renderList();
        }

        function sortProperties(sortBy) {
            switch(sortBy) {
                case 'price-desc':
                    filteredProperties.sort((a, b) => b.salePrice - a.salePrice);
                    break;
                case 'price-asc':
                    filteredProperties.sort((a, b) => a.salePrice - b.salePrice);
                    break;
                case 'sf-desc':
                    filteredProperties.sort((a, b) => b.buildingSize - a.buildingSize);
                    break;
            }
            renderProperties();
        }

        // Search
        let searchTimeout;
        function handleSearch(query) {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const activePropertyCategory = localStorage.getItem('activePropertyType') || 'commercial';
                if (query) {
                    filteredProperties = properties.filter(p => 
                        p.property_category === activePropertyCategory &&
                        (p.address.toLowerCase().includes(query.toLowerCase()) ||
                        p.city.toLowerCase().includes(query.toLowerCase()) ||
                        p.state.toLowerCase().includes(query.toLowerCase()))
                    );
                } else {
                    filteredProperties = properties.filter(p => p.property_category === activePropertyCategory);
                }
                renderProperties();
            }, 300);
        }

        // Actions
        function viewPropertyDetail(id) {
            // Route to appropriate detail page based on property type
            if (currentCompType === 'residential') {
                window.location.href = `SuperAdmin/super-admin-comp-view-detail-residential.html?id=${id}`;
            } else if (currentCompType === 'land') {
                window.location.href = `SuperAdmin/super-admin-comp-view-detail-land.html?id=${id}`;
            } else {
                // Commercial (default)
                window.location.href = `super-admin-comp-view-detail-commercial.html?id=${id}`;
            }
        }

        function editProperty(id) {
            window.location.href = `comp-edit-full-page.html?id=${id}`;
        }

        function deleteProperty(id) {
            if (confirm('Are you sure you want to delete this property?')) {
                filteredProperties = filteredProperties.filter(p => p.id !== id);
                renderProperties();
            }
        }

        function openFilters() {
            alert('Advanced filters panel would open here');
        }

        function changePage(direction) {
            alert(`Changing page: ${direction}`);
        }

        // Toggle lease/sale
        function toggleType(type) {
            document.getElementById('leaseToggle').classList.remove('active');
            document.getElementById('saleToggle').classList.remove('active');
            
            if (type === 'lease') {
                document.getElementById('leaseToggle').classList.add('active');
            } else {
                document.getElementById('saleToggle').classList.add('active');
            }
        }

        // Tab switching functionality
        let currentCompType = localStorage.getItem('activeCompType') || 'commercial';
        
        // Initialize on load
        window.onload = function() {
            console.log('Page loaded');
            console.log('Properties count:', properties.length);
            
            // Set the correct active tab on page load
            document.querySelectorAll('.comp-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            const activeTab = document.querySelector(`[data-type="${currentCompType}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            renderList();
        };
        
        function switchCompType(type) {
            currentCompType = type;
            
            // Update tab active states
            document.querySelectorAll('.comp-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            
            // Store in localStorage
            localStorage.setItem('activeCompType', type);
            
            // Filter properties by type
            filteredProperties = properties.filter(p => p.property_category === type);
            
            // Update the property list based on type
            renderList();
        }

        // Modal functions
        function openFiltersModal() {
            document.getElementById('filtersModal').classList.add('show');
        }

        function closeFiltersModal() {
            document.getElementById('filtersModal').classList.remove('show');
        }

        function openUploadModal() {
            document.getElementById('uploadModal').classList.add('show');
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('show');
            document.getElementById('fileInput').value = '';
            document.getElementById('fileList').innerHTML = '';
            resetUploadModal();
        }

        // Wizard functions removed - now using full-page layout at comps-create-full-page.html

        // Upload modal drag and drop
        let selectedFiles = [];

        function initUploadZone() {
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');

            if (uploadZone && fileInput) {
                uploadZone.addEventListener('click', (e) => {
                    e.stopPropagation();
                    fileInput.click();
                });
                
                uploadZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadZone.classList.add('drag-over');
                });
                
                uploadZone.addEventListener('dragleave', () => {
                    uploadZone.classList.remove('drag-over');
                });
                
                uploadZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadZone.classList.remove('drag-over');
                    handleFiles(e.dataTransfer.files);
                });

                fileInput.addEventListener('change', (e) => {
                    handleFiles(e.target.files);
                });
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initUploadZone);
        } else {
            initUploadZone();
        }

        function handleFiles(files) {
            selectedFiles = Array.from(files);
            displayFiles();
        }

        function displayFiles() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = selectedFiles.map((file, index) => `
                <div class="file-item">
                    <i class="material-icons file-icon">description</i>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                    <button class="file-remove" onclick="removeFile(${index})">
                        <i class="material-icons">close</i>
                    </button>
                </div>
            `).join('');
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFiles();
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        let currentUploadStep = 1;
        let currentCompareIndex = 0;

        function uploadFiles() {
            if (currentUploadStep === 1) {
                // For prototype: allow proceeding even without files for demo purposes
                // In production: if (selectedFiles.length === 0) return;
                
                // Move to processing step
                goToUploadStep(2);
                // Simulate processing delay
                setTimeout(() => {
                    goToUploadStep(3);
                }, 2000);
            } else if (currentUploadStep === 3) {
                // Move to success step
                goToUploadStep(4);
            }
        }

        function goToUploadStep(step) {
            currentUploadStep = step;
            const panel = document.getElementById('uploadModalPanel');
            const title = document.getElementById('uploadModalTitle');
            const footer = document.getElementById('uploadModalFooter');
            const uploadBtn = document.getElementById('uploadBtn');
            const cancelBtn = document.getElementById('uploadCancelBtn');

            // Hide all steps
            document.querySelectorAll('.upload-step').forEach(s => s.classList.remove('active'));
            
            // Show current step
            document.getElementById('uploadStep' + step).classList.add('active');

            // Update modal based on step
            if (step === 1) {
                panel.style.width = '600px';
                panel.classList.remove('upload-modal-expanded');
                title.textContent = 'Upload Comps';
                uploadBtn.textContent = 'Upload Files';
                uploadBtn.style.display = '';
                cancelBtn.textContent = 'Cancel';
            } else if (step === 2) {
                panel.style.width = '600px';
                title.textContent = 'Processing Upload';
                uploadBtn.style.display = 'none';
                cancelBtn.textContent = 'Cancel';
            } else if (step === 3) {
                panel.style.width = '';
                panel.classList.add('upload-modal-expanded');
                title.textContent = 'Review Duplicates';
                uploadBtn.textContent = 'Confirm & Save';
                uploadBtn.style.display = '';
                cancelBtn.textContent = 'Cancel Upload';
            } else if (step === 4) {
                panel.style.width = '600px';
                panel.classList.remove('upload-modal-expanded');
                title.textContent = 'Upload Complete';
                uploadBtn.textContent = 'Done';
                uploadBtn.onclick = closeUploadModal;
                cancelBtn.style.display = 'none';
            }
        }

        function resetUploadModal() {
            currentUploadStep = 1;
            const panel = document.getElementById('uploadModalPanel');
            const uploadBtn = document.getElementById('uploadBtn');
            const cancelBtn = document.getElementById('uploadCancelBtn');
            
            panel.style.width = '600px';
            panel.classList.remove('upload-modal-expanded');
            document.getElementById('uploadModalTitle').textContent = 'Upload Comps';
            
            document.querySelectorAll('.upload-step').forEach(s => s.classList.remove('active'));
            document.getElementById('uploadStep1').classList.add('active');
            
            uploadBtn.textContent = 'Upload Files';
            uploadBtn.style.display = '';
            uploadBtn.onclick = uploadFiles;
            cancelBtn.textContent = 'Cancel';
            cancelBtn.style.display = '';
            
            selectedFiles = [];
            document.getElementById('fileList').innerHTML = '';
        }

        function setBulkAction(action) {
            const selects = document.querySelectorAll('.duplicate-table .action-select');
            selects.forEach(select => {
                select.value = action;
            });
            updateActionCount();
        }

        function updateActionCount() {
            // This would update summary counts based on selections
            // For prototype, just visual feedback
        }

        function openCompareModal(index) {
            currentCompareIndex = index;
            document.getElementById('compareModal').classList.add('active');
        }

        function closeCompareModal() {
            document.getElementById('compareModal').classList.remove('active');
        }

        function setCompareAction(action) {
            // In real implementation, this would update the specific row's select
            // For prototype, just close the modal
        }

        // Update visibility radio button styles
        function updateVisibilityStyles() {
            const radios = document.querySelectorAll('input[name="uploadVisibility"]');
            radios.forEach(radio => {
                const label = radio.closest('label');
                if (radio.checked) {
                    label.style.borderColor = '#0da1c7';
                } else {
                    label.style.borderColor = '#e2e8f0';
                }
            });
        }
        
        // Initialize visibility styles on page load
        document.addEventListener('DOMContentLoaded', function() {
            const radios = document.querySelectorAll('input[name="uploadVisibility"]');
            radios.forEach(radio => {
                radio.addEventListener('change', updateVisibilityStyles);
            });
        });

        // Walkthrough functionality
        let currentWalkthroughStep = 0;
        const walkthroughSteps = [
            {
                target: 'walkthroughStep1',
                title: 'Summary Overview',
                text: 'This section shows a quick summary of your upload. You can see how many total comps were found, how many are new (will be added automatically), and how many are potential duplicates that need your review.',
                position: 'bottom'
            },
            {
                target: 'walkthroughStep2',
                title: 'Bulk Actions',
                text: 'Use these buttons to quickly apply the same action to ALL duplicate records at once. This saves time when you know you want to handle all duplicates the same way.',
                position: 'bottom'
            },
            {
                target: 'walkthroughStep3',
                title: 'Review Each Duplicate',
                text: 'This table shows each potential duplicate found in your upload. Review the address, sale date, and price to help identify if it\'s truly a duplicate.',
                position: 'top'
            },
            {
                target: null,
                targetSelector: '.match-badge',
                title: 'Match Confidence',
                text: 'The match percentage indicates how confident we are that this record already exists. Higher percentages (90%+) are very likely duplicates. Lower percentages may be similar but different properties.',
                position: 'left'
            },
            {
                target: null,
                targetSelector: '.action-select',
                title: 'Choose an Action',
                text: '<strong>Update Existing</strong> - Replace the old record with this new data<br><br><strong>Create as New</strong> - Keep both records (useful for different sale dates)<br><br><strong>Skip</strong> - Don\'t import this record',
                position: 'left'
            },
            {
                target: null,
                targetSelector: '.compare-btn',
                title: 'Compare Side-by-Side',
                text: 'Click "Compare" to see the uploaded data next to the existing record. This helps you decide whether to update, create new, or skip. Differences are highlighted in yellow.',
                position: 'left'
            }
        ];

        function startWalkthrough() {
            currentWalkthroughStep = 0;
            document.getElementById('walkthroughOverlay').classList.add('active');
            document.getElementById('duplicateHelpBanner').style.display = 'none';
            showWalkthroughStep();
        }

        function endWalkthrough() {
            document.getElementById('walkthroughOverlay').classList.remove('active');
            currentWalkthroughStep = 0;
        }

        function showWalkthroughStep() {
            const step = walkthroughSteps[currentWalkthroughStep];
            const highlight = document.getElementById('walkthroughHighlight');
            const tooltip = document.getElementById('walkthroughTooltip');
            
            // Find target element
            let targetEl;
            if (step.target) {
                targetEl = document.getElementById(step.target);
            } else if (step.targetSelector) {
                targetEl = document.querySelector(step.targetSelector);
            }

            if (targetEl) {
                // Scroll element into view if needed
                targetEl.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
                
                // Small delay to let scroll complete before positioning
                setTimeout(() => {
                    positionWalkthroughElements(targetEl, step);
                }, 100);
            } else {
                positionWalkthroughElements(null, step);
            }

            // Update content
            document.getElementById('walkthroughTitle').textContent = step.title;
            document.getElementById('walkthroughText').innerHTML = step.text;

            // Update step indicators
            const indicator = document.getElementById('walkthroughStepIndicator');
            indicator.innerHTML = walkthroughSteps.map((_, i) => {
                let className = 'walkthrough-step-dot';
                if (i < currentWalkthroughStep) className += ' completed';
                if (i === currentWalkthroughStep) className += ' active';
                return `<div class="${className}"></div>`;
            }).join('');

            // Update buttons
            document.getElementById('walkthroughBackBtn').style.display = currentWalkthroughStep === 0 ? 'none' : '';
            document.getElementById('walkthroughNextBtn').textContent = 
                currentWalkthroughStep === walkthroughSteps.length - 1 ? 'Finish' : 'Next';
        }

        function positionWalkthroughElements(targetEl, step) {
            const highlight = document.getElementById('walkthroughHighlight');
            const tooltip = document.getElementById('walkthroughTooltip');
            
            if (!targetEl) {
                highlight.style.display = 'none';
                return;
            }
            
            const rect = targetEl.getBoundingClientRect();
            const padding = 8;
            const viewportHeight = window.innerHeight;
            const viewportWidth = window.innerWidth;
                
            // Position highlight (fixed positioning - no scroll offset needed)
            highlight.style.top = (rect.top - padding) + 'px';
            highlight.style.left = (rect.left - padding) + 'px';
            highlight.style.width = (rect.width + padding * 2) + 'px';
            highlight.style.height = (rect.height + padding * 2) + 'px';
            highlight.style.display = 'block';

            // Position tooltip with viewport bounds checking
            const tooltipWidth = 320;
            const tooltipHeight = 220; // Approximate height
            const margin = 20;
            
            let tooltipTop, tooltipLeft;
            
            if (step.position === 'bottom') {
                tooltipTop = rect.bottom + padding + 16;
                tooltipLeft = Math.max(margin, Math.min(rect.left + rect.width/2 - tooltipWidth/2, viewportWidth - tooltipWidth - margin));
            } else if (step.position === 'top') {
                tooltipTop = rect.top - tooltipHeight - padding - 16;
                tooltipLeft = Math.max(margin, Math.min(rect.left + rect.width/2 - tooltipWidth/2, viewportWidth - tooltipWidth - margin));
            } else if (step.position === 'left') {
                tooltipTop = Math.max(margin, Math.min(rect.top, viewportHeight - tooltipHeight - margin));
                tooltipLeft = Math.max(margin, rect.left - tooltipWidth - padding - 16);
            } else {
                tooltipTop = Math.max(margin, Math.min(rect.top, viewportHeight - tooltipHeight - margin));
                tooltipLeft = Math.min(rect.right + padding + 16, viewportWidth - tooltipWidth - margin);
            }
            
            // Ensure tooltip doesn't go below viewport
            if (tooltipTop + tooltipHeight > viewportHeight - margin) {
                tooltipTop = viewportHeight - tooltipHeight - margin;
            }
            // Ensure tooltip doesn't go above viewport
            if (tooltipTop < margin) {
                tooltipTop = margin;
            }
            
            tooltip.style.top = tooltipTop + 'px';
            tooltip.style.left = tooltipLeft + 'px';
        }

        function nextWalkthroughStep() {
            if (currentWalkthroughStep < walkthroughSteps.length - 1) {
                currentWalkthroughStep++;
                showWalkthroughStep();
            } else {
                endWalkthrough();
            }
        }

        function prevWalkthroughStep() {
            if (currentWalkthroughStep > 0) {
                currentWalkthroughStep--;
                showWalkthroughStep();
            }
        }


        // Apply filters
        function applyFilters() {
            // Get all filter values
            const filters = {
                start_date: document.getElementById('filter_start_date')?.value,
                end_date: document.getElementById('filter_end_date')?.value,
                lease_type: document.getElementById('filter_lease_type')?.value,
                building_sf_min: document.getElementById('filter_building_sf_min')?.value,
                building_sf_max: document.getElementById('filter_building_sf_max')?.value,
                space_sf_min: document.getElementById('filter_space_sf_min')?.value,
                space_sf_max: document.getElementById('filter_space_sf_max')?.value,
                land_sf_min: document.getElementById('filter_land_sf_min')?.value,
                land_sf_max: document.getElementById('filter_land_sf_max')?.value,
                square_footage_min: document.getElementById('filter_square_footage_min')?.value,
                square_footage_max: document.getElementById('filter_square_footage_max')?.value,
                price_sf_min: document.getElementById('filter_price_sf_min')?.value,
                price_sf_max: document.getElementById('filter_price_sf_max')?.value,
                cap_rate_min: document.getElementById('filter_cap_rate_min')?.value,
                cap_rate_max: document.getElementById('filter_cap_rate_max')?.value,
                building_type: document.getElementById('filter_building_type')?.value,
                building_sub_type: document.getElementById('filter_building_sub_type')?.value,
                land_type: document.getElementById('filter_land_type')?.value,
                condition: document.getElementById('filter_condition')?.value,
                street_address: document.getElementById('filter_street_address')?.value,
                state: document.getElementById('filter_state')?.value,
                topography: document.getElementById('filter_topography')?.value,
                lot_shape: document.getElementById('filter_lot_shape')?.value,
                frontage: document.getElementById('filter_frontage')?.value,
                utilities: document.getElementById('filter_utilities')?.value
            };

            // Apply filters to current property list
            let filtered = [...properties];

            // Date filters
            if (filters.start_date) {
                filtered = filtered.filter(p => !p.dateSold || new Date(p.dateSold) >= new Date(filters.start_date));
            }
            if (filters.end_date) {
                filtered = filtered.filter(p => !p.dateSold || new Date(p.dateSold) <= new Date(filters.end_date));
            }

            // Size filters
            if (filters.building_sf_min) {
                filtered = filtered.filter(p => parseFloat(p.buildingSize?.replace(/,/g, '') || 0) >= parseFloat(filters.building_sf_min));
            }
            if (filters.building_sf_max) {
                filtered = filtered.filter(p => parseFloat(p.buildingSize?.replace(/,/g, '') || 0) <= parseFloat(filters.building_sf_max));
            }
            if (filters.land_sf_min) {
                filtered = filtered.filter(p => parseFloat(p.landSize?.replace(/,/g, '') || 0) >= parseFloat(filters.land_sf_min));
            }
            if (filters.land_sf_max) {
                filtered = filtered.filter(p => parseFloat(p.landSize?.replace(/,/g, '') || 0) <= parseFloat(filters.land_sf_max));
            }

            // Price filters
            if (filters.price_sf_min) {
                filtered = filtered.filter(p => parseFloat(p.pricePerSF?.replace(/[\$,]/g, '') || 0) >= parseFloat(filters.price_sf_min));
            }
            if (filters.price_sf_max) {
                filtered = filtered.filter(p => parseFloat(p.pricePerSF?.replace(/[\$,]/g, '') || 0) <= parseFloat(filters.price_sf_max));
            }

            // Property type filters
            if (filters.building_type) {
                filtered = filtered.filter(p => p.type?.toLowerCase().includes(filters.building_type.toLowerCase()));
            }
            if (filters.land_type) {
                filtered = filtered.filter(p => p.landType?.toLowerCase() === filters.land_type.toLowerCase());
            }
            if (filters.condition) {
                filtered = filtered.filter(p => p.condition?.toLowerCase() === filters.condition.toLowerCase());
            }

            // Location filters
            if (filters.street_address) {
                filtered = filtered.filter(p => p.address?.toLowerCase().includes(filters.street_address.toLowerCase()));
            }
            if (filters.state) {
                filtered = filtered.filter(p => p.location?.toLowerCase().includes(filters.state.toLowerCase()));
            }

            // Update the displayed properties
            properties = filtered;
            renderList();
            
            closeFiltersModal();
            
            // Show count of filtered results
            if (filtered.length < 8) {
                alert(`Filters applied! Showing ${filtered.length} of 8 results.`);
            }
        }

        function clearAllFilters() {
            // Reset all filter inputs
            document.querySelectorAll('.filter-input').forEach(input => {
                input.value = '';
            });
        }

        // Initialize on load
        window.addEventListener('load', () => {
            const savedType = localStorage.getItem('activeCompType');
            if (savedType) {
                switchCompType(savedType);
            }
        });

        // View Toggle Functions
        function showCompsView() {
            // Hide evaluation container
            document.getElementById('evaluationContainer').style.display = 'none';
            
            // Show comps containers
            document.getElementById('compTabs').style.display = 'flex';
            document.getElementById('compsControlBar').style.display = 'flex';
            document.getElementById('compsFilterTags').style.display = 'flex';
            document.getElementById('compsSplitContainer').style.display = 'flex';
            
            // Update navigation links
            document.getElementById('compsNavLink').classList.add('active');
            document.getElementById('evaluationNavLink').classList.remove('active');
        }

        function showEvaluationView() {
            // Hide comps-specific containers
            document.getElementById('compsControlBar').style.display = 'none';
            document.getElementById('compsFilterTags').style.display = 'none';
            document.getElementById('compsSplitContainer').style.display = 'none';
            
            // Keep comp tabs visible (Commercial/Residential/Land apply to evaluations too)
            document.getElementById('compTabs').style.display = 'flex';
            
            // Show evaluation container
            document.getElementById('evaluationContainer').style.display = 'block';
            
            // Update navigation links
            document.getElementById('compsNavLink').classList.remove('active');
            document.getElementById('evaluationNavLink').classList.add('active');
        }

        // Evaluation Filter Function
        function filterEvaluations(searchTerm) {
            const rows = document.querySelectorAll('#evaluationTableBody tr');
            const lowerSearch = searchTerm.toLowerCase();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                if (text.includes(lowerSearch)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Evaluation Pagination
        let currentPage = 1;
        const totalPages = 184;

        function goToPage(page) {
            if (page === 'prev') {
                if (currentPage > 1) {
                    currentPage--;
                }
            } else if (page === 'next') {
                if (currentPage < totalPages) {
                    currentPage++;
                }
            } else {
                currentPage = page;
            }
            
            // Update active state on pagination buttons
            document.querySelectorAll('.pagination-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent == currentPage) {
                    btn.classList.add('active');
                }
            });
            
            // In a real application, you would load the data for the current page here
            console.log('Navigated to page:', currentPage);
        }

        // Evaluation Action Functions
        function editEvaluation(id) {
            console.log('Edit evaluation:', id);
            // In a real application, this would navigate to the edit page
            alert('Edit evaluation #' + id);
        }

        function deleteEvaluation(id) {
            console.log('Delete evaluation:', id);
            if (confirm('Are you sure you want to delete this evaluation?')) {
                // In a real application, this would send a delete request
                alert('Evaluation #' + id + ' deleted');
            }
        }

        function downloadPDF(id) {
            console.log('Download PDF for evaluation:', id);
            // In a real application, this would download the PDF
            alert('Downloading PDF for evaluation #' + id);
        }
    </script>

    <!-- Filters Modal -->
    <div id="filtersModal" class="modal-overlay" onclick="if(event.target === this) closeFiltersModal()">
        <div class="modal-panel" style="width: 800px;" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title">Advanced Filters</h2>
                <button class="modal-close" onclick="closeFiltersModal()">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Date & Transaction Filters -->
                <div class="filter-section">
                    <div class="filter-section-title">Date & Transaction</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Start Date</label>
                            <input type="date" class="filter-input" id="filter_start_date">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">End Date</label>
                            <input type="date" class="filter-input" id="filter_end_date">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Lease Type</label>
                            <select class="filter-input" id="filter_lease_type">
                                <option value="">All Lease Types</option>
                                <option value="absolute_net">Absolute Net</option>
                                <option value="gross">Gross</option>
                                <option value="modified_gross">Modified Gross</option>
                                <option value="nnn">NNN</option>
                                <option value="modified_net">Modified Net</option>
                                <option value="full_service">Full Service</option>
                                <option value="ground_lease">Ground Lease</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Size Filters -->
                <div class="filter-section">
                    <div class="filter-section-title">Size</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Min Building SF</label>
                            <input type="number" class="filter-input" id="filter_building_sf_min" placeholder="0">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Building SF</label>
                            <input type="number" class="filter-input" id="filter_building_sf_max" placeholder="100,000">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Min Space SF</label>
                            <input type="number" class="filter-input" id="filter_space_sf_min" placeholder="0">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Space SF</label>
                            <input type="number" class="filter-input" id="filter_space_sf_max" placeholder="50,000">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Min Land SF</label>
                            <input type="number" class="filter-input" id="filter_land_sf_min" placeholder="0">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Land SF</label>
                            <input type="number" class="filter-input" id="filter_land_sf_max" placeholder="500,000">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Min Square Footage</label>
                            <input type="number" class="filter-input" id="filter_square_footage_min" placeholder="0">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Square Footage</label>
                            <input type="number" class="filter-input" id="filter_square_footage_max" placeholder="10,000">
                        </div>
                    </div>
                </div>

                <!-- Price Filters -->
                <div class="filter-section">
                    <div class="filter-section-title">Price</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Min Price $/SF</label>
                            <input type="number" class="filter-input" id="filter_price_sf_min" placeholder="0">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Price $/SF</label>
                            <input type="number" class="filter-input" id="filter_price_sf_max" placeholder="500">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Min Cap Rate (%)</label>
                            <input type="number" class="filter-input" id="filter_cap_rate_min" placeholder="0" step="0.1">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Max Cap Rate (%)</label>
                            <input type="number" class="filter-input" id="filter_cap_rate_max" placeholder="15" step="0.1">
                        </div>
                    </div>
                </div>

                <!-- Property Type Filters -->
                <div class="filter-section">
                    <div class="filter-section-title">Property Type</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Building Type</label>
                            <select class="filter-input" id="filter_building_type">
                                <option value="">All Building Types</option>
                                <option value="office">Office</option>
                                <option value="retail">Retail</option>
                                <option value="industrial">Industrial</option>
                                <option value="multi_family">Multi-Family</option>
                                <option value="hospitality">Hospitality</option>
                                <option value="special">Special</option>
                                <option value="residential">Residential</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Building Sub Type</label>
                            <select class="filter-input" id="filter_building_sub_type">
                                <option value="">All Sub Types</option>
                                <option value="medical_office_condo">Medical Office Condo</option>
                                <option value="multi_tenant">Multi-Tenant</option>
                                <option value="professional_office_condo">Professional Office Condo</option>
                                <option value="bank">Bank</option>
                                <option value="c_store">C-Store</option>
                                <option value="gas_station">Gas Station</option>
                                <option value="grocery_store">Grocery Store</option>
                                <option value="distribution">Distribution</option>
                                <option value="warehouse_shop">Warehouse/Shop</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Land Type</label>
                            <select class="filter-input" id="filter_land_type">
                                <option value="">All Land Types</option>
                                <option value="ag">Agricultural</option>
                                <option value="cbd">Central Business District (CBD)</option>
                                <option value="industrial">Industrial</option>
                                <option value="residential_2_10_units">Residential - 2-10 Units</option>
                                <option value="residential_development">Residential - Development</option>
                                <option value="residential_multi_family">Residential - Multi-Family</option>
                                <option value="residential_single_family">Residential - Single Family</option>
                                <option value="retail_office">Retail/Office</option>
                                <option value="subdivisions">Subdivisions</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Condition</label>
                            <select class="filter-input" id="filter_condition">
                                <option value="">All Conditions</option>
                                <option value="excellent">Excellent</option>
                                <option value="very_good">Very Good</option>
                                <option value="good">Good</option>
                                <option value="average">Average</option>
                                <option value="fair">Fair</option>
                                <option value="poor">Poor</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Location Filters -->
                <div class="filter-section">
                    <div class="filter-section-title">Location</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Street Address</label>
                            <input type="text" class="filter-input" id="filter_street_address" placeholder="Enter street address">
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">State</label>
                            <input type="text" class="filter-input" id="filter_state" placeholder="e.g. CA, NY, TX">
                        </div>
                    </div>
                </div>

                <!-- Site Details (for specific comp types) -->
                <div class="filter-section">
                    <div class="filter-section-title">Site Details</div>
                    <div class="filter-grid">
                        <div class="filter-field">
                            <label class="filter-label">Topography</label>
                            <select class="filter-input" id="filter_topography">
                                <option value="">All</option>
                                <option value="level">Level</option>
                                <option value="sloped">Sloped</option>
                                <option value="very_sloped">Very Sloped</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Lot Shape</label>
                            <select class="filter-input" id="filter_lot_shape">
                                <option value="">All</option>
                                <option value="Rectangular">Rectangular</option>
                                <option value="Square">Square</option>
                                <option value="Irregular">Irregular</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Frontage</label>
                            <select class="filter-input" id="filter_frontage">
                                <option value="">All</option>
                                <option value="poor">Poor</option>
                                <option value="fair">Fair</option>
                                <option value="average">Average</option>
                                <option value="good">Good</option>
                                <option value="very_good">Very Good</option>
                                <option value="excellent">Excellent</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label class="filter-label">Utilities</label>
                            <select class="filter-input" id="filter_utilities">
                                <option value="">All</option>
                                <option value="Full City Services">Full City Services</option>
                                <option value="Septic and Cistern">Septic and Cistern</option>
                                <option value="Septic and Well">Septic and Well</option>
                                <option value="Community Sewer and Water">Community Sewer and Water</option>
                                <option value="No City Services">No City Services</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="clearAllFilters()">Clear All</button>
                <div style="display: flex; gap: 12px;">
                    <button class="btn-secondary" onclick="closeFiltersModal()">Cancel</button>
                    <button class="btn-primary" onclick="applyFilters()">Apply Filters</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal-overlay" onclick="if(event.target === this) closeUploadModal()">
        <div class="modal-panel" id="uploadModalPanel" style="width: 600px;" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title" id="uploadModalTitle">Upload Comps</h2>
                <button class="modal-close" onclick="closeUploadModal()">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Step 1: Upload Zone -->
                <div id="uploadStep1" class="upload-step active">
                    <div id="uploadZone" class="upload-zone">
                        <i class="material-icons upload-icon">cloud_upload</i>
                        <div class="upload-text">Drag and drop files here, or click to browse</div>
                        <div class="upload-hint">Supported formats: CSV, Excel (.xlsx, .xls), PDF</div>
                        <div class="upload-hint" style="margin-top: 8px;">Maximum file size: 10MB</div>
                    </div>
                    <input type="file" id="fileInput" multiple accept=".csv,.xlsx,.xls,.pdf" style="display: none;">
                    <div id="fileList" class="file-list"></div>

                    <!-- Privacy/Sharing Options -->
                    <div class="upload-privacy-section" style="margin-top: 24px; padding: 20px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                            <i class="material-icons" style="color: #0da1c7; font-size: 20px;">visibility</i>
                            <span style="font-size: 14px; font-weight: 600; color: #1c3643;">Visibility Settings</span>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <label style="display: flex; align-items: flex-start; gap: 12px; padding: 14px 16px; background: white; border: 2px solid #0da1c7; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="uploadVisibility" value="shared" checked style="margin-top: 2px; accent-color: #0da1c7;">
                                <div>
                                    <div style="font-size: 14px; font-weight: 600; color: #1c3643; margin-bottom: 2px;">
                                        <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px; color: #0da1c7;">group</i>
                                        Share with Account
                                    </div>
                                    <div style="font-size: 12px; color: #687F8B;">All users in your account can view and use these comps</div>
                                </div>
                            </label>
                            
                            <label style="display: flex; align-items: flex-start; gap: 12px; padding: 14px 16px; background: white; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.2s;" onmouseenter="this.style.borderColor='#cbd5e1'" onmouseleave="if(!this.querySelector('input').checked) this.style.borderColor='#e2e8f0'">
                                <input type="radio" name="uploadVisibility" value="private" style="margin-top: 2px; accent-color: #0da1c7;" onchange="updateVisibilityStyles()">
                                <div>
                                    <div style="font-size: 14px; font-weight: 600; color: #1c3643; margin-bottom: 2px;">
                                        <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px; color: #687F8B;">lock</i>
                                        Keep Private
                                    </div>
                                    <div style="font-size: 12px; color: #687F8B;">Only you and account admins can view these comps</div>
                                </div>
                            </label>
                        </div>
                        
                        <div style="margin-top: 12px; padding: 10px 12px; background: #f0f9ff; border-radius: 6px; border-left: 3px solid #0da1c7;">
                            <div style="font-size: 11px; color: #0369a1;">
                                <i class="material-icons" style="font-size: 14px; vertical-align: middle; margin-right: 4px;">info</i>
                                You can change visibility for individual comps later from the comp detail page.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Processing -->
                <div id="uploadStep2" class="upload-step">
                    <div class="upload-progress">
                        <div class="upload-spinner"></div>
                        <div class="upload-progress-text">Processing your files...</div>
                        <div class="upload-progress-subtext">Extracting comp data and checking for duplicates</div>
                    </div>
                </div>

                <!-- Step 3: Duplicate Review -->
                <div id="uploadStep3" class="upload-step">
                    <!-- Help Banner for First-Time Users -->
                    <div class="help-banner" id="duplicateHelpBanner">
                        <div class="help-banner-icon">
                            <i class="material-icons">lightbulb</i>
                        </div>
                        <div class="help-banner-content">
                            <div class="help-banner-title">First time reviewing duplicates?</div>
                            <div class="help-banner-text">
                                We found records in your upload that may already exist in your database. Review each one and choose whether to create a new record, update the existing one, or skip it entirely.
                            </div>
                            <div class="help-banner-actions">
                                <button class="help-banner-btn primary" onclick="startWalkthrough()">
                                    <i class="material-icons" style="font-size: 14px; vertical-align: middle; margin-right: 4px;">play_arrow</i>
                                    Take a Quick Tour
                                </button>
                                <button class="help-banner-btn secondary" onclick="document.getElementById('duplicateHelpBanner').style.display='none'">
                                    I've got it
                                </button>
                            </div>
                        </div>
                        <button class="help-banner-dismiss" onclick="document.getElementById('duplicateHelpBanner').style.display='none'">x</button>
                    </div>

                    <div class="upload-step-header" style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div>
                            <div class="upload-step-title">Review Uploaded Comps</div>
                            <div class="upload-step-desc">We found potential duplicates in your upload. Choose how to handle each one.</div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <a href="super-admin-comp-bulk-upload-review.html" target="_blank" class="help-header-btn" style="text-decoration: none;">
                                <i class="material-icons">open_in_new</i>
                                Full View
                            </a>
                            <button class="help-header-btn" onclick="startWalkthrough()">
                                <i class="material-icons">help_outline</i>
                                Help
                            </button>
                        </div>
                    </div>

                    <div class="duplicate-summary" id="walkthroughStep1">
                        <div class="summary-stat total">
                            <div class="summary-stat-value" id="totalCompsCount">24</div>
                            <div class="summary-stat-label">
                                Total Comps
                                <span class="help-icon">?
                                    <span class="help-tooltip">The total number of comp records found in your uploaded file(s).</span>
                                </span>
                            </div>
                        </div>
                        <div class="summary-stat new">
                            <div class="summary-stat-value" id="newCompsCount">18</div>
                            <div class="summary-stat-label">
                                New Records
                                <span class="help-icon">?
                                    <span class="help-tooltip">Records that don't match anything in your database. These will be added automatically.</span>
                                </span>
                            </div>
                        </div>
                        <div class="summary-stat duplicate">
                            <div class="summary-stat-value" id="duplicateCompsCount">6</div>
                            <div class="summary-stat-label">
                                Duplicates Found
                                <span class="help-icon">?
                                    <span class="help-tooltip">Records that may already exist in your database. Review each one below to decide how to handle them.</span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="bulk-actions" id="walkthroughStep2">
                        <div class="bulk-actions-left">
                            <span style="font-size: 13px; color: #687F8B;">
                                Bulk Actions for Duplicates:
                                <span class="help-icon">?
                                    <span class="help-tooltip">Apply the same action to all duplicate records at once. You can still change individual records in the table below.</span>
                                </span>
                            </span>
                            <button class="bulk-action-btn create-all" onclick="setBulkAction('create')">Create All New</button>
                            <button class="bulk-action-btn update-all" onclick="setBulkAction('update')">Update All Existing</button>
                            <button class="bulk-action-btn skip-all" onclick="setBulkAction('skip')">Skip All</button>
                        </div>
                    </div>

                    <div class="duplicate-table-container" id="walkthroughStep3">
                        <table class="duplicate-table">
                            <thead>
                                <tr>
                                    <th style="width: 200px;">Address</th>
                                    <th style="width: 100px;">Sale Date</th>
                                    <th style="width: 110px;">Sale Price</th>
                                    <th style="width: 100px;">
                                        Match
                                        <span class="help-icon">?
                                            <span class="help-tooltip">Match confidence indicates how likely this record already exists in your database. Higher percentages mean a stronger match based on address, date, and price.</span>
                                        </span>
                                    </th>
                                    <th style="width: 140px;">
                                        Action
                                        <span class="help-icon">?
                                            <span class="help-tooltip"><strong>Update Existing:</strong> Replace the existing record with this data.<br><br><strong>Create as New:</strong> Add this as a separate record.<br><br><strong>Skip:</strong> Don't import this record.</span>
                                        </span>
                                    </th>
                                    <th style="width: 180px;">
                                        Note
                                        <span class="help-icon">?
                                            <span class="help-tooltip">Add an optional note to document why you made this decision. Notes are saved to the audit log.</span>
                                        </span>
                                    </th>
                                    <th style="width: 80px;"></th>
                                </tr>
                            </thead>
                            <tbody id="duplicateTableBody">
                                <tr>
                                    <td><strong>123 Main Street</strong><br><span style="font-size: 11px; color: #687F8B;">Denver, CO 80202</span></td>
                                    <td>03/15/2024</td>
                                    <td>$4,250,000</td>
                                    <td><span class="match-badge high">98% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update" selected>Update Existing</option>
                                            <option value="create">Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..." value="Updated per county records"></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(1)">Compare</button></td>
                                </tr>
                                <tr>
                                    <td><strong>456 Oak Avenue</strong><br><span style="font-size: 11px; color: #687F8B;">Boulder, CO 80301</span></td>
                                    <td>02/28/2024</td>
                                    <td>$2,875,000</td>
                                    <td><span class="match-badge high">95% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update" selected>Update Existing</option>
                                            <option value="create">Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..."></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(2)">Compare</button></td>
                                </tr>
                                <tr>
                                    <td><strong>789 Pine Road</strong><br><span style="font-size: 11px; color: #687F8B;">Fort Collins, CO 80525</span></td>
                                    <td>01/20/2024</td>
                                    <td>$1,650,000</td>
                                    <td><span class="match-badge medium">78% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update">Update Existing</option>
                                            <option value="create" selected>Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..." value="Different sale date - new transaction"></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(3)">Compare</button></td>
                                </tr>
                                <tr>
                                    <td><strong>321 Elm Street</strong><br><span style="font-size: 11px; color: #687F8B;">Lakewood, CO 80226</span></td>
                                    <td>03/01/2024</td>
                                    <td>$3,100,000</td>
                                    <td><span class="match-badge high">92% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update" selected>Update Existing</option>
                                            <option value="create">Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..."></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(4)">Compare</button></td>
                                </tr>
                                <tr>
                                    <td><strong>555 Maple Drive</strong><br><span style="font-size: 11px; color: #687F8B;">Aurora, CO 80012</span></td>
                                    <td>02/15/2024</td>
                                    <td>$985,000</td>
                                    <td><span class="match-badge low">65% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update">Update Existing</option>
                                            <option value="create" selected>Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..." value="Low match - likely different property"></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(5)">Compare</button></td>
                                </tr>
                                <tr>
                                    <td><strong>888 Cedar Lane</strong><br><span style="font-size: 11px; color: #687F8B;">Arvada, CO 80002</span></td>
                                    <td>03/10/2024</td>
                                    <td>$2,450,000</td>
                                    <td><span class="match-badge high">96% Match</span></td>
                                    <td>
                                        <select class="action-select" onchange="updateActionCount()">
                                            <option value="update" selected>Update Existing</option>
                                            <option value="create">Create as New</option>
                                            <option value="skip">Skip</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="note-input-small" placeholder="Add note..."></td>
                                    <td><button class="compare-btn" onclick="openCompareModal(6)">Compare</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Step 4: Success -->
                <div id="uploadStep4" class="upload-step">
                    <div class="upload-success">
                        <div class="success-icon">
                            <i class="material-icons">check</i>
                        </div>
                        <div class="success-title">Upload Complete</div>
                        <div class="success-desc">Your comps have been processed and saved to the database.</div>
                        <div class="success-stats">
                            <div class="success-stat">
                                <div class="success-stat-value" id="finalCreatedCount">20</div>
                                <div class="success-stat-label">Created</div>
                            </div>
                            <div class="success-stat">
                                <div class="success-stat-value" id="finalUpdatedCount">4</div>
                                <div class="success-stat-label">Updated</div>
                            </div>
                            <div class="success-stat">
                                <div class="success-stat-value" id="finalSkippedCount">0</div>
                                <div class="success-stat-label">Skipped</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="uploadModalFooter">
                <div></div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn-secondary" onclick="closeUploadModal()" id="uploadCancelBtn">Cancel</button>
                    <button class="btn-primary" onclick="uploadFiles()" id="uploadBtn">Upload Files</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Walkthrough Overlay -->
    <div id="walkthroughOverlay" class="walkthrough-overlay" onclick="if(event.target === this) endWalkthrough()">
        <div class="walkthrough-highlight" id="walkthroughHighlight"></div>
        <div class="walkthrough-tooltip" id="walkthroughTooltip" onclick="event.stopPropagation()">
            <div class="walkthrough-step-indicator" id="walkthroughStepIndicator"></div>
            <div class="walkthrough-title" id="walkthroughTitle"></div>
            <div class="walkthrough-text" id="walkthroughText"></div>
            <div class="walkthrough-actions">
                <button class="walkthrough-skip" onclick="endWalkthrough()">Skip tour</button>
                <div class="walkthrough-nav">
                    <button class="walkthrough-btn back" id="walkthroughBackBtn" onclick="prevWalkthroughStep()">Back</button>
                    <button class="walkthrough-btn next" id="walkthroughNextBtn" onclick="nextWalkthroughStep()">Next</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Compare Modal (nested) -->
    <div id="compareModal" class="compare-modal-overlay" onclick="if(event.target === this) closeCompareModal()">
        <div class="compare-modal" onclick="event.stopPropagation()">
            <div class="compare-modal-header">
                <h3>Compare: 123 Main Street</h3>
                <button class="compare-modal-close" onclick="closeCompareModal()">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div class="compare-modal-body">
                <div class="compare-grid">
                    <div class="compare-column uploaded">
                        <div class="compare-column-header">Uploaded Data (New)</div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Sale Price</span>
                            <span class="compare-field-value">$4,250,000</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Sale Date</span>
                            <span class="compare-field-value">03/15/2024</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">Address</span>
                            <span class="compare-field-value">123 Main Street</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">City</span>
                            <span class="compare-field-value">Denver</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">State</span>
                            <span class="compare-field-value">CO</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">Property Type</span>
                            <span class="compare-field-value">Office</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Building SF</span>
                            <span class="compare-field-value">45,200 SF</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Cap Rate</span>
                            <span class="compare-field-value">6.5%</span>
                        </div>
                    </div>
                    <div class="compare-column existing">
                        <div class="compare-column-header">Existing Record (In Database)</div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Sale Price</span>
                            <span class="compare-field-value">$4,100,000</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Sale Date</span>
                            <span class="compare-field-value">01/10/2024</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">Address</span>
                            <span class="compare-field-value">123 Main Street</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">City</span>
                            <span class="compare-field-value">Denver</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">State</span>
                            <span class="compare-field-value">CO</span>
                        </div>
                        <div class="compare-field">
                            <span class="compare-field-label">Property Type</span>
                            <span class="compare-field-value">Office</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Building SF</span>
                            <span class="compare-field-value">44,800 SF</span>
                        </div>
                        <div class="compare-field different">
                            <span class="compare-field-label">Cap Rate</span>
                            <span class="compare-field-value">6.8%</span>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 16px; padding: 12px; background: #fef3c7; border-radius: 6px; border-left: 3px solid #f59e0b;">
                    <div style="font-size: 12px; font-weight: 600; color: #92400e; margin-bottom: 4px;">Differences Highlighted</div>
                    <div style="font-size: 13px; color: #92400e;">4 fields differ between uploaded and existing data. Yellow highlighted rows show fields with different values.</div>
                </div>

                <!-- Notes Section -->
                <div style="margin-top: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e0e0e0;">
                    <label style="display: block; font-size: 12px; font-weight: 600; color: #687F8B; text-transform: uppercase; margin-bottom: 8px;">
                        Add a Note (Optional)
                        <span class="help-icon" style="margin-left: 4px;">?
                            <span class="help-tooltip">Document why you're making this decision. Notes are saved to the audit log for future reference.</span>
                        </span>
                    </label>
                    <textarea id="compareNoteInput" placeholder="e.g., Updated sale price reflects final closing docs from county records..." style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; font-family: inherit; resize: vertical; min-height: 60px; box-sizing: border-box;"></textarea>
                </div>
            </div>
            <div class="compare-modal-footer">
                <button class="btn-secondary" onclick="closeCompareModal()">Close</button>
                <button class="btn-secondary" onclick="setCompareAction('skip'); closeCompareModal()" style="background: #f5f5f5;">Skip This Comp</button>
                <button class="btn-secondary" onclick="setCompareAction('create'); closeCompareModal()" style="background: #f0fdf4; border-color: #bbf7d0; color: #059669;">Create as New</button>
                <button class="btn-primary" onclick="setCompareAction('update'); closeCompareModal()">Update Existing</button>
            </div>
        </div>
    </div>

    <!-- Evaluation Wizard Modal -->
    <div id="evaluationWizardModal" class="wizard-modal-overlay" onclick="if(event.target === this) closeEvaluationWizard()">
        <div class="wizard-modal" onclick="event.stopPropagation()">
            <button class="wizard-close" onclick="closeEvaluationWizard()">&times;</button>
            
            <div class="wizard-container">
                <!-- Wizard Title -->
                <h1 class="wizard-title">CREATE NEW EVALUATION</h1>
                <p class="wizard-subtitle">Follow the steps below to create your evaluation report</p>

                <!-- Wizard Steps -->
                <div class="wizard-steps">
                    <div class="wizard-step">
                        <div class="step-circle completed">âœ“</div>
                        <div class="step-label">Property Info</div>
                    </div>
                    <div class="step-arrow">â†’</div>
                    <div class="wizard-step">
                        <div class="step-circle active">2</div>
                        <div class="step-label active">Report Template</div>
                    </div>
                    <div class="step-arrow">â†’</div>
                    <div class="wizard-step">
                        <div class="step-circle">3</div>
                        <div class="step-label">Property Details</div>
                    </div>
                    <div class="step-arrow">â†’</div>
                    <div class="wizard-step">
                        <div class="step-circle">4</div>
                        <div class="step-label">Valuations</div>
                    </div>
                    <div class="step-arrow">â†’</div>
                    <div class="wizard-step">
                        <div class="step-circle">5</div>
                        <div class="step-label">Review</div>
                    </div>
                </div>

                <!-- Main Card -->
                <div class="wizard-card">
                    <div class="card-title">Select Report Template</div>
                    <div class="card-subtitle">
                        Choose a template that determines which sections and fields will appear in your final report. You can customize this later if needed.
                    </div>

                    <!-- Info Box -->
                    <div class="info-box">
                        <div class="info-box-title">ðŸ’¡ What are report templates?</div>
                        <div class="info-box-text">
                            Report templates allow you to control what appears in your final PDF. Your administrator has created pre-configured templates for different scenarios (bank submissions, quick valuations, etc.). Select the one that best fits your needs.
                        </div>
                    </div>

                    <!-- Template Options -->
                    <div class="template-selector">
                        <div class="template-option selected" onclick="selectTemplate('standard')">
                            <div class="template-option-header">
                                <div class="template-option-title">
                                    <span class="radio-circle"></span>
                                    Standard Full Report
                                </div>
                                <div class="template-badge default">DEFAULT</div>
                            </div>
                            <div class="template-option-desc">
                                Complete evaluation report with all sections including executive summary, property details, all valuation approaches, and exhibits. Recommended for most uses.
                            </div>
                            <div class="template-option-meta">
                                <span>7 sections enabled</span>
                                <span>~25-35 pages</span>
                            </div>
                        </div>

                        <div class="template-option" onclick="selectTemplate('quick')">
                            <div class="template-option-header">
                                <div class="template-option-title">
                                    <span class="radio-circle"></span>
                                    Quick Valuation
                                </div>
                            </div>
                            <div class="template-option-desc">
                                Streamlined report focusing on executive summary, property overview, and primary valuation approach. Ideal for internal reviews and quick turnarounds.
                            </div>
                            <div class="template-option-meta">
                                <span>3 sections enabled</span>
                                <span>~10-15 pages</span>
                            </div>
                        </div>

                        <div class="template-option" onclick="selectTemplate('bank')">
                            <div class="template-option-header">
                                <div class="template-option-title">
                                    <span class="radio-circle"></span>
                                    Bank Submission
                                </div>
                            </div>
                            <div class="template-option-desc">
                                Comprehensive report optimized for bank underwriting requirements. Includes detailed assumptions, all valuation approaches, and complete exhibits.
                            </div>
                            <div class="template-option-meta">
                                <span>6 sections enabled</span>
                                <span>~30-40 pages</span>
                            </div>
                        </div>

                        <div class="template-option" onclick="selectTemplate('internal')">
                            <div class="template-option-header">
                                <div class="template-option-title">
                                    <span class="radio-circle"></span>
                                    Internal Use Only
                                </div>
                            </div>
                            <div class="template-option-desc">
                                Minimal report for internal team review. Includes essential valuation data without client-facing sections like About Us or detailed assumptions.
                            </div>
                            <div class="template-option-meta">
                                <span>4 sections enabled</span>
                                <span>~12-18 pages</span>
                            </div>
                        </div>
                    </div>

                    <!-- Preview Section -->
                    <div class="preview-section" id="wizardTemplatePreview">
                        <div class="preview-title">Template Preview: Standard Full Report</div>
                        <div class="preview-list">
                            <div class="preview-item enabled"><span class="check">âœ“</span> Cover Page</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Letter of Engagement</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Table of Contents</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Executive Summary</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Property Summary</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Valuations (All Approaches)</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Weighted Value</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> About Us</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Assumptions</div>
                            <div class="preview-item enabled"><span class="check">âœ“</span> Exhibits</div>
                        </div>
                    </div>

                    <!-- Navigation Actions -->
                    <div class="wizard-actions">
                        <button class="action-button action-button-secondary" onclick="wizardGoBack()">
                            â† Back
                        </button>
                        <button class="action-button btn-primary" onclick="wizardContinue()">
                            Continue to Property Details â†’
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Evaluation Wizard Functions
        let wizardSelectedTemplate = 'standard';

        const wizardTemplateData = {
            'standard': {
                name: 'Standard Full Report',
                sections: [
                    { name: 'Cover Page', enabled: true },
                    { name: 'Letter of Engagement', enabled: true },
                    { name: 'Table of Contents', enabled: true },
                    { name: 'Executive Summary', enabled: true },
                    { name: 'Property Summary', enabled: true },
                    { name: 'Valuations (All Approaches)', enabled: true },
                    { name: 'Weighted Value', enabled: true },
                    { name: 'About Us', enabled: true },
                    { name: 'Assumptions', enabled: true },
                    { name: 'Exhibits', enabled: true }
                ]
            },
            'quick': {
                name: 'Quick Valuation',
                sections: [
                    { name: 'Cover Page', enabled: true },
                    { name: 'Letter of Engagement', enabled: false },
                    { name: 'Table of Contents', enabled: true },
                    { name: 'Executive Summary', enabled: true },
                    { name: 'Property Summary', enabled: true },
                    { name: 'Valuations (Sales Only)', enabled: true },
                    { name: 'Weighted Value', enabled: true },
                    { name: 'About Us', enabled: false },
                    { name: 'Assumptions', enabled: false },
                    { name: 'Exhibits', enabled: false }
                ]
            },
            'bank': {
                name: 'Bank Submission',
                sections: [
                    { name: 'Cover Page', enabled: true },
                    { name: 'Letter of Engagement', enabled: true },
                    { name: 'Table of Contents', enabled: true },
                    { name: 'Executive Summary', enabled: true },
                    { name: 'Property Summary', enabled: true },
                    { name: 'Valuations (All Approaches)', enabled: true },
                    { name: 'Weighted Value', enabled: true },
                    { name: 'About Us', enabled: true },
                    { name: 'Assumptions', enabled: true },
                    { name: 'Exhibits', enabled: true }
                ]
            },
            'internal': {
                name: 'Internal Use Only',
                sections: [
                    { name: 'Cover Page', enabled: true },
                    { name: 'Letter of Engagement', enabled: false },
                    { name: 'Table of Contents', enabled: false },
                    { name: 'Executive Summary', enabled: true },
                    { name: 'Property Summary', enabled: true },
                    { name: 'Valuations (Primary Only)', enabled: true },
                    { name: 'Weighted Value', enabled: true },
                    { name: 'About Us', enabled: false },
                    { name: 'Assumptions', enabled: false },
                    { name: 'Exhibits', enabled: false }
                ]
            }
        };

        function openEvaluationWizard() {
            document.getElementById('evaluationWizardModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeEvaluationWizard() {
            document.getElementById('evaluationWizardModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function selectTemplate(templateId) {
            wizardSelectedTemplate = templateId;
            
            // Update visual selection
            const modal = document.getElementById('evaluationWizardModal');
            modal.querySelectorAll('.template-option').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Update preview
            updateWizardPreview();
        }

        function updateWizardPreview() {
            const template = wizardTemplateData[wizardSelectedTemplate];
            const previewEl = document.getElementById('wizardTemplatePreview');
            
            let html = `<div class="preview-title">Template Preview: ${template.name}</div>`;
            html += '<div class="preview-list">';
            
            template.sections.forEach(section => {
                const icon = section.enabled ? 'âœ“' : 'âœ—';
                const className = section.enabled ? 'enabled' : '';
                const iconClass = section.enabled ? 'check' : 'cross';
                html += `<div class="preview-item ${className}"><span class="${iconClass}">${icon}</span> ${section.name}</div>`;
            });
            
            html += '</div>';
            previewEl.innerHTML = html;
        }

        function wizardContinue() {
            alert(`Template "${wizardTemplateData[wizardSelectedTemplate].name}" selected. Continuing to property details...\n\n(This is a prototype - in production, this would proceed to the next step)`);
            closeEvaluationWizard();
        }

        function wizardGoBack() {
            alert('Going back to property information...\n\n(This is a prototype)');
        }

        // Initialize wizard preview
        document.addEventListener('DOMContentLoaded', () => {
            updateWizardPreview();
        });
    </script>
</body>
</html>
