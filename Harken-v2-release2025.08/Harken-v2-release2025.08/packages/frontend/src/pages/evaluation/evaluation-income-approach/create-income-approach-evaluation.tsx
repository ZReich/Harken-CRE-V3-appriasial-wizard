import { Typography } from '@mui/material';
import ErrorOutlineIcon from '@mui/icons-material/ErrorOutline';
import EvaluationIncomeApprochForm from './evaluation-income-form';
import EvaluationMenuOptions from '../set-up/evaluation-menu-options';
import { useState } from 'react';
import { useRef } from 'react';

const EvaluationCreatIncomeApproch = () => {
  const [indicatedCapRateFromChild, setIndicatedCapRateFromChild] = useState(0);
  const [indicatedSfAnnualFromChild, setIndicatedSfAnnualFromChild] =
    useState(0);
  const [updateEvalWeightInParent, setUpdateEvalWeightInParent] = useState(0);
  const [totalWeightedValue, setTotalWeightedValue] = useState(0);
  console.log('newdataaaa');
  const handleNextClick = () => {
    // const capRate = incomeFormRef.current?.getIndicatedCapRate();
    // console.log('Indicated Cap Rate:', capRate);

    if (incomeFormRef.current?.onNextClick) {
      incomeFormRef.current.onNextClick();
    } else {
      console.warn('onNextClick is not defined on incomeFormRef');
    }
  };
  console.log('updateEvalWeightInParent', updateEvalWeightInParent);
  const handleBackClick = () => {
    if (incomeFormRef.current?.onBackClick) {
      incomeFormRef.current.onBackClick();
    } else {
      console.warn('onNextClick is not defined on incomeFormRef');
    }
  };
  // const incomeFormRef = useRef<EvaluationIncomeApprochFormRef>(null);
  const incomeFormRef = useRef<any>(null);
  const [matchedApproch, setMatchedApproch] = useState('');
  const matchName = (event: any) => {
    setMatchedApproch(event);
  };
  // console.log('indicatedMarketRate,indicatedMarketRate', indicatedMarketRate);
  return (
    <>
      <EvaluationMenuOptions
        onNextClick={handleNextClick}
        onBackClick={handleBackClick}
        indicatedCapRate={indicatedCapRateFromChild}
        indicatedSfAnnualRate={indicatedSfAnnualFromChild}
        onUpdateEvalWeightChange={(value: any) => {
          setUpdateEvalWeightInParent(value);
        }}
        onTotalWeightedChange={(value: any) => {
          setTotalWeightedValue(value);
        }}
      >
        <div>
          <div className="flex items-center justify-between h-[50px] w-[100%] xl:pl-[40px] border-0 border-b border-[#eee] border-solid xl:pr-[70px] px-[15px] map-header-sticky">
            <Typography
              variant="h1"
              component="h2"
              className="text-xl font-bold uppercase"
            >
              INCOME APPROACH{matchedApproch ? ` (${matchedApproch})` : ''}
            </Typography>
            <div className="flex items-center">
              <ErrorOutlineIcon className="pr-[10px] w-[30px] h-[30px]" />
              <span className="text-xs">
                Enter information about the income and expenses generated by the
                property.
              </span>
            </div>
          </div>
        </div>
        {/* <div> */}
        <div className="p-5 xl:px-14 px-4 ">
          <EvaluationIncomeApprochForm
            ref={incomeFormRef}
            matchName={matchName}
            totalWeightedValue={totalWeightedValue}
            onIndicatedCapRateChange={setIndicatedCapRateFromChild}
            onIndicatedPsfAnnualRateChange={setIndicatedSfAnnualFromChild}
            evalWeights={updateEvalWeightInParent}
            // indicatedMarketRate={indicatedMarketRate}
          />
        </div>

        {/* </div> */}
      </EvaluationMenuOptions>
    </>
  );
};
export default EvaluationCreatIncomeApproch;
