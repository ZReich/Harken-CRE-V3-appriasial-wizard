<!doctype html>
<html>
	<head>
		<title><%= data?.title ? data.title + ' | ' : '' %>Harken CRE</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link href="/public/harken.png" type="image/png" rel="shortcut icon" />

		<link rel="stylesheet" type="text/css" href="/reportCss/main.css" />
		<link rel="stylesheet" type="text/css" href="/reportCss/cdn.css" media="all" />
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.css" media="all" />

		<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="/scripts/cdn.js"></script>
		<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?key=<%= googleApiKey %>" type="text/javascript" ></script>
		<script type="text/javascript" src="/scripts/main.min.js"></script>
		<script type="text/javascript" src="/scripts/main.min.worker.js"></script>

		<!-- Quill -->
		<script src="//cdn.quilljs.com/1.3.6/quill.js"></script>
		<script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
		<link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet" />
		<link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet" />

		<script src="/scripts/loadingoverlay.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
		<style type="text/css" media="print">
			@media print {
				body {
					-webkit-print-color-adjust: exact;
				}

				@page {
					size: 8.5in 11in landscape;
					margin: 0;
					-webkit-print-color-adjust: exact;
					-moz-print-color-adjust: exact;
				}
			}
		</style>

		<style>
			<%
			let color = "";
			if (data.theme) {
			    if (data.theme === 'default' && !data.primary_color) {
			        color = '#0DA1C7';
			    } else if (data.theme === 'nai' && !data.primary_color) {
			        color = '#af2d37';
			    } else if (data.theme === 'nai_portland' && !data.primary_color) {
			        color = '#63666a';
			    } else if (data.theme === 'stockman' && !data.primary_color) {
			        color = '#006f51';
			    }
			    if (color !== "") {
			        data.primary_color = color;
			        data.secondary_color = colourBrightness(data.primary_color, -0.15);
			        data.tertiary_color = colourBrightness(data.primary_color, -0.25);
			    }
			} else {
			    if (!data.primary_color) data.primary_color = '#0DA1C7';
			    if (!data.secondary_color) data.secondary_color = colourBrightness(data.primary_color, -0.15);
			    if (!data.tertiary_color) data.tertiary_color = colourBrightness(data.primary_color, -0.25);
			}

			function colourBrightness(hex, percent) {
			    hex = hex.replace(/[^0-9a-f]/gi, '');
			    if (hex.length < 6) {
			        hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
			    }
			    let result = '#';
			    for (let i = 0; i < 3; i++) {
			        let dec = parseInt(hex.substr(i*2, 2), 16);
			        dec = Math.min(255, Math.max(0, dec + dec * percent));
			        result += ('0' + Math.round(dec).toString(16)).slice(-2);
			    }
			    return result;
			}
			%>
			<% if (data.primary_color) { %>
			:root {
			    --primary: <%= data.primary_color %> !important;
			    --secondary: <%= data.secondary_color %> !important;
			    --tertiary: <%= data.tertiary_color %> !important;
			}
			<% } %>
		</style>
	</head>

	<body
		id="evaluation-report" 
		data-evaluation-id="<%= data.evaluation_id %>" 
		data-filename="<%= data.filename %>" 
		class="<%= data.theme ? 'theme-' + data.theme : 'theme-blue-default' %>" 
		proxy-url="<%= repoertImageProxyURL %>" 
		data-cdn-url="<%= data.cdnUrl %>" 
		loader-image="/images/loading.png" >

		<input id="checkPDFComplete" value="false" type="hidden" />
		<div id="evaluation-report-data" data-color="<%= data.primary_color %>">